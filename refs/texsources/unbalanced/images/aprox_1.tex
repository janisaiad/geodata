\begin{tikzpicture}
\iffalse
import sys
import numpy as np
p = np.linspace(-3, 3, 121)
a, b = 0.5, 1.5
eps, rho = 1, 1

# Range
range = p.copy()
range[p < eps * np.log(a)] -= eps * np.log(a)
range[(p >= eps * np.log(a)) * (p <= eps * np.log(b))] = 0
range[p > eps * np.log(b)] -= eps * np.log(b)

# TV
tv = p.copy()
tv[p < -rho] = -rho
tv[p > rho] = rho

values = np.stack((p, p, range, tv)).T
np.savetxt(sys.stdout, values, fmt="%.3f")
\fi

    \pgfplotstableread{
    p balanced range tv
    -3.000 -3.000 -2.307 -1.000
    -2.950 -2.950 -2.257 -1.000
    -2.900 -2.900 -2.207 -1.000
    -2.850 -2.850 -2.157 -1.000
    -2.800 -2.800 -2.107 -1.000
    -2.750 -2.750 -2.057 -1.000
    -2.700 -2.700 -2.007 -1.000
    -2.650 -2.650 -1.957 -1.000
    -2.600 -2.600 -1.907 -1.000
    -2.550 -2.550 -1.857 -1.000
    -2.500 -2.500 -1.807 -1.000
    -2.450 -2.450 -1.757 -1.000
    -2.400 -2.400 -1.707 -1.000
    -2.350 -2.350 -1.657 -1.000
    -2.300 -2.300 -1.607 -1.000
    -2.250 -2.250 -1.557 -1.000
    -2.200 -2.200 -1.507 -1.000
    -2.150 -2.150 -1.457 -1.000
    -2.100 -2.100 -1.407 -1.000
    -2.050 -2.050 -1.357 -1.000
    -2.000 -2.000 -1.307 -1.000
    -1.950 -1.950 -1.257 -1.000
    -1.900 -1.900 -1.207 -1.000
    -1.850 -1.850 -1.157 -1.000
    -1.800 -1.800 -1.107 -1.000
    -1.750 -1.750 -1.057 -1.000
    -1.700 -1.700 -1.007 -1.000
    -1.650 -1.650 -0.957 -1.000
    -1.600 -1.600 -0.907 -1.000
    -1.550 -1.550 -0.857 -1.000
    -1.500 -1.500 -0.807 -1.000
    -1.450 -1.450 -0.757 -1.000
    -1.400 -1.400 -0.707 -1.000
    -1.350 -1.350 -0.657 -1.000
    -1.300 -1.300 -0.607 -1.000
    -1.250 -1.250 -0.557 -1.000
    -1.200 -1.200 -0.507 -1.000
    -1.150 -1.150 -0.457 -1.000
    -1.100 -1.100 -0.407 -1.000
    -1.050 -1.050 -0.357 -1.000
    -1.000 -1.000 -0.307 -1.000
    -0.950 -0.950 -0.257 -0.950
    -0.900 -0.900 -0.207 -0.900
    -0.850 -0.850 -0.157 -0.850
    -0.800 -0.800 -0.107 -0.800
    -0.750 -0.750 -0.057 -0.750
    -0.700 -0.700 -0.007 -0.700
    -0.650 -0.650 0.000 -0.650
    -0.600 -0.600 0.000 -0.600
    -0.550 -0.550 0.000 -0.550
    -0.500 -0.500 0.000 -0.500
    -0.450 -0.450 0.000 -0.450
    -0.400 -0.400 0.000 -0.400
    -0.350 -0.350 0.000 -0.350
    -0.300 -0.300 0.000 -0.300
    -0.250 -0.250 0.000 -0.250
    -0.200 -0.200 0.000 -0.200
    -0.150 -0.150 0.000 -0.150
    -0.100 -0.100 0.000 -0.100
    -0.050 -0.050 0.000 -0.050
    0.000 0.000 0.000 0.000
    0.050 0.050 0.000 0.050
    0.100 0.100 0.000 0.100
    0.150 0.150 0.000 0.150
    0.200 0.200 0.000 0.200
    0.250 0.250 0.000 0.250
    0.300 0.300 0.000 0.300
    0.350 0.350 0.000 0.350
    0.400 0.400 0.000 0.400
    0.450 0.450 0.045 0.450
    0.500 0.500 0.095 0.500
    0.550 0.550 0.145 0.550
    0.600 0.600 0.195 0.600
    0.650 0.650 0.245 0.650
    0.700 0.700 0.295 0.700
    0.750 0.750 0.345 0.750
    0.800 0.800 0.395 0.800
    0.850 0.850 0.445 0.850
    0.900 0.900 0.495 0.900
    0.950 0.950 0.545 0.950
    1.000 1.000 0.595 1.000
    1.050 1.050 0.645 1.000
    1.100 1.100 0.695 1.000
    1.150 1.150 0.745 1.000
    1.200 1.200 0.795 1.000
    1.250 1.250 0.845 1.000
    1.300 1.300 0.895 1.000
    1.350 1.350 0.945 1.000
    1.400 1.400 0.995 1.000
    1.450 1.450 1.045 1.000
    1.500 1.500 1.095 1.000
    1.550 1.550 1.145 1.000
    1.600 1.600 1.195 1.000
    1.650 1.650 1.245 1.000
    1.700 1.700 1.295 1.000
    1.750 1.750 1.345 1.000
    1.800 1.800 1.395 1.000
    1.850 1.850 1.445 1.000
    1.900 1.900 1.495 1.000
    1.950 1.950 1.545 1.000
    2.000 2.000 1.595 1.000
    2.050 2.050 1.645 1.000
    2.100 2.100 1.695 1.000
    2.150 2.150 1.745 1.000
    2.200 2.200 1.795 1.000
    2.250 2.250 1.845 1.000
    2.300 2.300 1.895 1.000
    2.350 2.350 1.945 1.000
    2.400 2.400 1.995 1.000
    2.450 2.450 2.045 1.000
    2.500 2.500 2.095 1.000
    2.550 2.550 2.145 1.000
    2.600 2.600 2.195 1.000
    2.650 2.650 2.245 1.000
    2.700 2.700 2.295 1.000
    2.750 2.750 2.345 1.000
    2.800 2.800 2.395 1.000
    2.850 2.850 2.445 1.000
    2.900 2.900 2.495 1.000
    2.950 2.950 2.545 1.000
    3.000 3.000 2.595 1.000
    }\datatable
          
  
  \begin{axis}[width=.5\textwidth,
              grid=both,ymin=-3, ymax=3, xmin=-3, xmax=3,
      %title={\scriptsize We run NumPy, PyTorch and KeOps on a RTX 2080 Ti GPU.},
              xlabel={\scriptsize $p$}, 
              ylabel={\scriptsize $-\aprox{\phi^*}(-p)$}, 
              xtick={-3,-2,-1,0,1,2,3},
              %xticklabels={100,1k,10k,100k,1M},
              ytick={-3,-2,-1,0,1,2,3},
              %yticklabels={1\,ms,10\,ms,100\,ms,1\,s,10\,s},
              %xmode=log, ymode=log,
              legend pos = south east,
              %x post scale=1.7,
              grid=major,
            legend cell align={left},
            axis background/.style={fill=white},
            label style={font=\tiny},
            tick label style={font=\tiny},
            axis equal image,]
      \addplot[red!80, very thick,] table[x=p,y=balanced]  {\datatable};
      \addplot[blue!50, very thick, dashed] table[x=p,y=range]  {\datatable};
      \addplot[green!80!black, very thick, dotted] table[x=p,y=tv]  {\datatable};
      \addlegendentry{{\small Balanced}}
      \addlegendentry{{\small Range [0.5, 1.5]}}
      \addlegendentry{{\small TV}}
  \end{axis}
  \end{tikzpicture}