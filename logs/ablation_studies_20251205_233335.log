2025-12-05 23:33:35,993 - INFO - ================================================================================
2025-12-05 23:33:35,994 - INFO - DÉMARRAGE DES ÉTUDES D'ABLATION
2025-12-05 23:33:35,994 - INFO - ================================================================================
2025-12-05 23:33:35,994 - INFO - Loading images...
2025-12-05 23:33:36,151 - INFO - Source: torch.Size([3, 458, 343]), Target: torch.Size([3, 457, 341])
2025-12-05 23:33:36,151 - INFO - Source image: 458x343, Target image: 457x341
2025-12-05 23:33:36,151 - INFO - Using resolutions: source=256, target=256 (capped at 256)
2025-12-05 23:33:36,151 - INFO - Resolution config: (256, 256)
2025-12-05 23:33:36,151 - INFO - Nombre total d'expériences: 2560
2025-12-05 23:33:36,151 - INFO - Lambda values: [0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 10.0, 50.0, 100.0]
2025-12-05 23:33:36,151 - INFO - 
[1/2560] exp_0001_eps0.010_rhobalanced_lam0.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:33:36,152 - INFO -   eps=0.010, rho=None, lambda=0.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:33:36,451 - INFO -   Cloud sizes: source=48896, target=48896
2025-12-05 23:33:36,602 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:36,874 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 8.91 GiB. GPU 0 has a total capacity of 19.53 GiB of which 1.35 GiB is free. Including non-PyTorch memory, this process has 18.03 GiB memory in use. Of the allocated memory 17.82 GiB is allocated by PyTorch, and 17.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 55, in squared_distances
    return D_xx - 2 * D_xy + D_yy
           ~~~~~^~~~~~~~~~
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.91 GiB. GPU 0 has a total capacity of 19.53 GiB of which 1.35 GiB is free. Including non-PyTorch memory, this process has 18.03 GiB memory in use. Of the allocated memory 17.82 GiB is allocated by PyTorch, and 17.64 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 55, in squared_distances
    return D_xx - 2 * D_xy + D_yy
                  ~~^~~~~~
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.91 GiB. GPU 0 has a total capacity of 19.53 GiB of which 1.35 GiB is free. Including non-PyTorch memory, this process has 18.03 GiB memory in use. Of the allocated memory 17.82 GiB is allocated by PyTorch, and 17.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:36,877 - INFO - 
[2/2560] exp_0002_eps0.010_rhobalanced_lam0.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:33:36,877 - INFO -   eps=0.010, rho=None, lambda=0.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:33:36,997 - INFO -   Cloud sizes: source=48896, target=48896
2025-12-05 23:33:37,259 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:37,534 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 8.91 GiB. GPU 0 has a total capacity of 19.53 GiB of which 1.35 GiB is free. Including non-PyTorch memory, this process has 18.03 GiB memory in use. Of the allocated memory 17.82 GiB is allocated by PyTorch, and 17.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 55, in squared_distances
    return D_xx - 2 * D_xy + D_yy
           ~~~~~^~~~~~~~~~
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.91 GiB. GPU 0 has a total capacity of 19.53 GiB of which 1.35 GiB is free. Including non-PyTorch memory, this process has 18.03 GiB memory in use. Of the allocated memory 17.82 GiB is allocated by PyTorch, and 17.64 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 55, in squared_distances
    return D_xx - 2 * D_xy + D_yy
                  ~~^~~~~~
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.91 GiB. GPU 0 has a total capacity of 19.53 GiB of which 1.35 GiB is free. Including non-PyTorch memory, this process has 18.03 GiB memory in use. Of the allocated memory 17.82 GiB is allocated by PyTorch, and 17.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:37,538 - INFO - 
[3/2560] exp_0003_eps0.010_rhobalanced_lam0.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:33:37,538 - INFO -   eps=0.010, rho=None, lambda=0.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:33:37,653 - INFO -   Cloud sizes: source=48896, target=48896
2025-12-05 23:33:37,932 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:38,202 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 8.91 GiB. GPU 0 has a total capacity of 19.53 GiB of which 1.35 GiB is free. Including non-PyTorch memory, this process has 18.03 GiB memory in use. Of the allocated memory 17.82 GiB is allocated by PyTorch, and 17.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 55, in squared_distances
    return D_xx - 2 * D_xy + D_yy
           ~~~~~^~~~~~~~~~
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.91 GiB. GPU 0 has a total capacity of 19.53 GiB of which 1.35 GiB is free. Including non-PyTorch memory, this process has 18.03 GiB memory in use. Of the allocated memory 17.82 GiB is allocated by PyTorch, and 17.64 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 55, in squared_distances
    return D_xx - 2 * D_xy + D_yy
                  ~~^~~~~~
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.91 GiB. GPU 0 has a total capacity of 19.53 GiB of which 1.35 GiB is free. Including non-PyTorch memory, this process has 18.03 GiB memory in use. Of the allocated memory 17.82 GiB is allocated by PyTorch, and 17.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:38,204 - INFO - 
[4/2560] exp_0004_eps0.010_rhobalanced_lam0.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:33:38,205 - INFO -   eps=0.010, rho=None, lambda=0.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:33:38,306 - INFO -   Cloud sizes: source=48896, target=48896
2025-12-05 23:33:38,593 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:38,866 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 8.91 GiB. GPU 0 has a total capacity of 19.53 GiB of which 1.35 GiB is free. Including non-PyTorch memory, this process has 18.03 GiB memory in use. Of the allocated memory 17.82 GiB is allocated by PyTorch, and 17.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 55, in squared_distances
    return D_xx - 2 * D_xy + D_yy
           ~~~~~^~~~~~~~~~
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.91 GiB. GPU 0 has a total capacity of 19.53 GiB of which 1.35 GiB is free. Including non-PyTorch memory, this process has 18.03 GiB memory in use. Of the allocated memory 17.82 GiB is allocated by PyTorch, and 17.64 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 55, in squared_distances
    return D_xx - 2 * D_xy + D_yy
                  ~~^~~~~~
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.91 GiB. GPU 0 has a total capacity of 19.53 GiB of which 1.35 GiB is free. Including non-PyTorch memory, this process has 18.03 GiB memory in use. Of the allocated memory 17.82 GiB is allocated by PyTorch, and 17.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:38,868 - INFO - 
[5/2560] exp_0005_eps0.010_rhobalanced_lam0.5_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:33:38,868 - INFO -   eps=0.010, rho=None, lambda=0.5, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:33:38,983 - INFO -   Cloud sizes: source=48896, target=48896
2025-12-05 23:33:39,250 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:39,520 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 8.91 GiB. GPU 0 has a total capacity of 19.53 GiB of which 1.35 GiB is free. Including non-PyTorch memory, this process has 18.03 GiB memory in use. Of the allocated memory 17.82 GiB is allocated by PyTorch, and 17.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 55, in squared_distances
    return D_xx - 2 * D_xy + D_yy
           ~~~~~^~~~~~~~~~
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.91 GiB. GPU 0 has a total capacity of 19.53 GiB of which 1.35 GiB is free. Including non-PyTorch memory, this process has 18.03 GiB memory in use. Of the allocated memory 17.82 GiB is allocated by PyTorch, and 17.64 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 55, in squared_distances
    return D_xx - 2 * D_xy + D_yy
                  ~~^~~~~~
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.91 GiB. GPU 0 has a total capacity of 19.53 GiB of which 1.35 GiB is free. Including non-PyTorch memory, this process has 18.03 GiB memory in use. Of the allocated memory 17.82 GiB is allocated by PyTorch, and 17.27 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:39,521 - INFO - 
[6/2560] exp_0006_eps0.010_rhobalanced_lam0.5_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:33:39,521 - INFO -   eps=0.010, rho=None, lambda=0.5, debias=False, dyn_rast=False, adapt_sigma=True
