2025-12-05 23:33:20,108 - INFO - ================================================================================
2025-12-05 23:33:20,108 - INFO - DÉMARRAGE DES ÉTUDES D'ABLATION
2025-12-05 23:33:20,109 - INFO - ================================================================================
2025-12-05 23:33:20,109 - INFO - Loading images...
2025-12-05 23:33:20,263 - INFO - Source: torch.Size([3, 458, 343]), Target: torch.Size([3, 457, 341])
2025-12-05 23:33:20,263 - INFO - Source image: 458x343, Target image: 457x341
2025-12-05 23:33:20,263 - INFO - Using resolutions: source=458, target=457 (capped at 1024)
2025-12-05 23:33:20,263 - INFO - Resolution config: (458, 457)
2025-12-05 23:33:20,263 - INFO - Nombre total d'expériences: 2560
2025-12-05 23:33:20,263 - INFO - Lambda values: [0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 10.0, 50.0, 100.0]
2025-12-05 23:33:20,264 - INFO - 
[1/2560] exp_0001_eps0.010_rhobalanced_lam0.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:33:20,264 - INFO -   eps=0.010, rho=None, lambda=0.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:33:20,427 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:20,469 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:20,504 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:20,506 - INFO - 
[2/2560] exp_0002_eps0.010_rhobalanced_lam0.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:33:20,506 - INFO -   eps=0.010, rho=None, lambda=0.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:33:20,543 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:20,579 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:20,614 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:20,615 - INFO - 
[3/2560] exp_0003_eps0.010_rhobalanced_lam0.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:33:20,615 - INFO -   eps=0.010, rho=None, lambda=0.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:33:20,651 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:20,688 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:20,724 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:20,726 - INFO - 
[4/2560] exp_0004_eps0.010_rhobalanced_lam0.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:33:20,726 - INFO -   eps=0.010, rho=None, lambda=0.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:33:20,761 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:20,794 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:20,829 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:20,831 - INFO - 
[5/2560] exp_0005_eps0.010_rhobalanced_lam0.5_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:33:20,831 - INFO -   eps=0.010, rho=None, lambda=0.5, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:33:20,868 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:20,903 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:20,936 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:20,938 - INFO - 
[6/2560] exp_0006_eps0.010_rhobalanced_lam0.5_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:33:20,938 - INFO -   eps=0.010, rho=None, lambda=0.5, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:33:20,972 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:21,006 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:21,041 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:21,042 - INFO - 
[7/2560] exp_0007_eps0.010_rhobalanced_lam0.5_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:33:21,042 - INFO -   eps=0.010, rho=None, lambda=0.5, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:33:21,078 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:21,111 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:21,146 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:21,148 - INFO - 
[8/2560] exp_0008_eps0.010_rhobalanced_lam0.5_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:33:21,148 - INFO -   eps=0.010, rho=None, lambda=0.5, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:33:21,180 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:21,213 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:21,245 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:21,247 - INFO - 
[9/2560] exp_0009_eps0.010_rhobalanced_lam1.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:33:21,247 - INFO -   eps=0.010, rho=None, lambda=1.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:33:21,281 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:21,315 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:21,349 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:21,351 - INFO - 
[10/2560] exp_0010_eps0.010_rhobalanced_lam1.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:33:21,351 - INFO -   eps=0.010, rho=None, lambda=1.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:33:21,384 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:21,417 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:21,448 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:21,450 - INFO - 
[11/2560] exp_0011_eps0.010_rhobalanced_lam1.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:33:21,451 - INFO -   eps=0.010, rho=None, lambda=1.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:33:21,484 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:21,517 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:21,550 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:21,552 - INFO - 
[12/2560] exp_0012_eps0.010_rhobalanced_lam1.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:33:21,552 - INFO -   eps=0.010, rho=None, lambda=1.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:33:21,586 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:21,622 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:21,656 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:21,657 - INFO - 
[13/2560] exp_0013_eps0.010_rhobalanced_lam1.5_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:33:21,657 - INFO -   eps=0.010, rho=None, lambda=1.5, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:33:21,690 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:21,721 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:21,758 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:21,759 - INFO - 
[14/2560] exp_0014_eps0.010_rhobalanced_lam1.5_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:33:21,760 - INFO -   eps=0.010, rho=None, lambda=1.5, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:33:21,795 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:21,832 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:21,870 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:21,872 - INFO - 
[15/2560] exp_0015_eps0.010_rhobalanced_lam1.5_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:33:21,872 - INFO -   eps=0.010, rho=None, lambda=1.5, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:33:21,907 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:21,942 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:21,978 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:21,980 - INFO - 
[16/2560] exp_0016_eps0.010_rhobalanced_lam1.5_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:33:21,980 - INFO -   eps=0.010, rho=None, lambda=1.5, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:33:22,018 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:22,054 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:22,091 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:22,093 - INFO - 
[17/2560] exp_0017_eps0.010_rhobalanced_lam2.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:33:22,093 - INFO -   eps=0.010, rho=None, lambda=2.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:33:22,128 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:22,162 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:22,197 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:22,199 - INFO - 
[18/2560] exp_0018_eps0.010_rhobalanced_lam2.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:33:22,199 - INFO -   eps=0.010, rho=None, lambda=2.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:33:22,234 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:22,274 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:22,309 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:22,311 - INFO - 
[19/2560] exp_0019_eps0.010_rhobalanced_lam2.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:33:22,311 - INFO -   eps=0.010, rho=None, lambda=2.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:33:22,346 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:22,380 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:22,414 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:22,416 - INFO - 
[20/2560] exp_0020_eps0.010_rhobalanced_lam2.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:33:22,416 - INFO -   eps=0.010, rho=None, lambda=2.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:33:22,450 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:22,486 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:22,521 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:22,522 - INFO - 
[21/2560] exp_0021_eps0.010_rhobalanced_lam2.5_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:33:22,522 - INFO -   eps=0.010, rho=None, lambda=2.5, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:33:22,557 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:22,592 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:22,629 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:22,631 - INFO - 
[22/2560] exp_0022_eps0.010_rhobalanced_lam2.5_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:33:22,631 - INFO -   eps=0.010, rho=None, lambda=2.5, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:33:22,666 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:22,701 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:22,736 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:22,737 - INFO - 
[23/2560] exp_0023_eps0.010_rhobalanced_lam2.5_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:33:22,737 - INFO -   eps=0.010, rho=None, lambda=2.5, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:33:22,770 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:22,803 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:22,839 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:22,840 - INFO - 
[24/2560] exp_0024_eps0.010_rhobalanced_lam2.5_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:33:22,840 - INFO -   eps=0.010, rho=None, lambda=2.5, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:33:22,877 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:22,912 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:22,947 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:22,949 - INFO - 
[25/2560] exp_0025_eps0.010_rhobalanced_lam3.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:33:22,949 - INFO -   eps=0.010, rho=None, lambda=3.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:33:22,982 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:23,016 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:23,051 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:23,052 - INFO - 
[26/2560] exp_0026_eps0.010_rhobalanced_lam3.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:33:23,052 - INFO -   eps=0.010, rho=None, lambda=3.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:33:23,088 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:23,123 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:23,162 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:23,163 - INFO - 
[27/2560] exp_0027_eps0.010_rhobalanced_lam3.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:33:23,163 - INFO -   eps=0.010, rho=None, lambda=3.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:33:23,198 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:23,231 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:23,262 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:23,264 - INFO - 
[28/2560] exp_0028_eps0.010_rhobalanced_lam3.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:33:23,264 - INFO -   eps=0.010, rho=None, lambda=3.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:33:23,299 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:23,334 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:23,371 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:23,373 - INFO - 
[29/2560] exp_0029_eps0.010_rhobalanced_lam10_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:33:23,373 - INFO -   eps=0.010, rho=None, lambda=10.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:33:23,407 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:23,443 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:23,478 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:23,480 - INFO - 
[30/2560] exp_0030_eps0.010_rhobalanced_lam10_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:33:23,480 - INFO -   eps=0.010, rho=None, lambda=10.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:33:23,514 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:23,549 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:23,584 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:23,586 - INFO - 
[31/2560] exp_0031_eps0.010_rhobalanced_lam10_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:33:23,586 - INFO -   eps=0.010, rho=None, lambda=10.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:33:23,620 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:23,653 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:23,690 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:23,692 - INFO - 
[32/2560] exp_0032_eps0.010_rhobalanced_lam10_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:33:23,692 - INFO -   eps=0.010, rho=None, lambda=10.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:33:23,727 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:23,762 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:23,799 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:23,801 - INFO - 
[33/2560] exp_0033_eps0.010_rhobalanced_lam50_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:33:23,801 - INFO -   eps=0.010, rho=None, lambda=50.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:33:23,835 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:23,870 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:23,906 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:23,907 - INFO - 
[34/2560] exp_0034_eps0.010_rhobalanced_lam50_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:33:23,908 - INFO -   eps=0.010, rho=None, lambda=50.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:33:23,942 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:23,977 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:24,014 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:24,015 - INFO - 
[35/2560] exp_0035_eps0.010_rhobalanced_lam50_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:33:24,015 - INFO -   eps=0.010, rho=None, lambda=50.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:33:24,050 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:24,085 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:24,118 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:24,120 - INFO - 
[36/2560] exp_0036_eps0.010_rhobalanced_lam50_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:33:24,120 - INFO -   eps=0.010, rho=None, lambda=50.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:33:24,155 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:24,190 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:24,226 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:24,227 - INFO - 
[37/2560] exp_0037_eps0.010_rhobalanced_lam100_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:33:24,227 - INFO -   eps=0.010, rho=None, lambda=100.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:33:24,261 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:24,297 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:24,331 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:24,333 - INFO - 
[38/2560] exp_0038_eps0.010_rhobalanced_lam100_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:33:24,333 - INFO -   eps=0.010, rho=None, lambda=100.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:33:24,369 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:24,405 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:24,441 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:24,442 - INFO - 
[39/2560] exp_0039_eps0.010_rhobalanced_lam100_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:33:24,442 - INFO -   eps=0.010, rho=None, lambda=100.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:33:24,478 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:24,511 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:24,545 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:24,547 - INFO - 
[40/2560] exp_0040_eps0.010_rhobalanced_lam100_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:33:24,547 - INFO -   eps=0.010, rho=None, lambda=100.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:33:24,581 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:24,617 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:24,653 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:24,654 - INFO - 
[41/2560] exp_0041_eps0.010_rho0.01_lam0.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:33:24,654 - INFO -   eps=0.010, rho=0.01, lambda=0.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:33:24,688 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:24,722 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:24,757 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:24,758 - INFO - 
[42/2560] exp_0042_eps0.010_rho0.01_lam0.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:33:24,758 - INFO -   eps=0.010, rho=0.01, lambda=0.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:33:24,793 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:24,828 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:24,863 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:24,865 - INFO - 
[43/2560] exp_0043_eps0.010_rho0.01_lam0.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:33:24,865 - INFO -   eps=0.010, rho=0.01, lambda=0.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:33:24,900 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:24,934 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:24,970 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:24,971 - INFO - 
[44/2560] exp_0044_eps0.010_rho0.01_lam0.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:33:24,971 - INFO -   eps=0.010, rho=0.01, lambda=0.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:33:25,007 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:25,045 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:25,080 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:25,081 - INFO - 
[45/2560] exp_0045_eps0.010_rho0.01_lam0.5_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:33:25,081 - INFO -   eps=0.010, rho=0.01, lambda=0.5, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:33:25,114 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:25,150 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:25,183 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:25,185 - INFO - 
[46/2560] exp_0046_eps0.010_rho0.01_lam0.5_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:33:25,185 - INFO -   eps=0.010, rho=0.01, lambda=0.5, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:33:25,221 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:25,255 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:25,291 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:25,292 - INFO - 
[47/2560] exp_0047_eps0.010_rho0.01_lam0.5_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:33:25,293 - INFO -   eps=0.010, rho=0.01, lambda=0.5, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:33:25,327 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:25,361 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:25,397 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:25,398 - INFO - 
[48/2560] exp_0048_eps0.010_rho0.01_lam0.5_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:33:25,399 - INFO -   eps=0.010, rho=0.01, lambda=0.5, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:33:25,436 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:25,472 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:25,507 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:25,509 - INFO - 
[49/2560] exp_0049_eps0.010_rho0.01_lam1.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:33:25,509 - INFO -   eps=0.010, rho=0.01, lambda=1.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:33:25,543 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:25,577 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:25,613 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:25,615 - INFO - 
[50/2560] exp_0050_eps0.010_rho0.01_lam1.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:33:25,615 - INFO -   eps=0.010, rho=0.01, lambda=1.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:33:25,650 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:25,684 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:25,720 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:25,721 - INFO - 
[51/2560] exp_0051_eps0.010_rho0.01_lam1.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:33:25,721 - INFO -   eps=0.010, rho=0.01, lambda=1.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:33:25,759 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:25,795 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:25,832 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:25,834 - INFO - 
[52/2560] exp_0052_eps0.010_rho0.01_lam1.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:33:25,834 - INFO -   eps=0.010, rho=0.01, lambda=1.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:33:25,872 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:25,908 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:25,944 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:25,945 - INFO - 
[53/2560] exp_0053_eps0.010_rho0.01_lam1.5_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:33:25,946 - INFO -   eps=0.010, rho=0.01, lambda=1.5, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:33:25,982 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:26,016 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:26,053 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:26,054 - INFO - 
[54/2560] exp_0054_eps0.010_rho0.01_lam1.5_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:33:26,055 - INFO -   eps=0.010, rho=0.01, lambda=1.5, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:33:26,091 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:26,127 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:26,162 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:26,164 - INFO - 
[55/2560] exp_0055_eps0.010_rho0.01_lam1.5_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:33:26,164 - INFO -   eps=0.010, rho=0.01, lambda=1.5, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:33:26,198 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:26,232 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:26,267 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:26,269 - INFO - 
[56/2560] exp_0056_eps0.010_rho0.01_lam1.5_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:33:26,269 - INFO -   eps=0.010, rho=0.01, lambda=1.5, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:33:26,305 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:26,340 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:26,374 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:26,375 - INFO - 
[57/2560] exp_0057_eps0.010_rho0.01_lam2.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:33:26,376 - INFO -   eps=0.010, rho=0.01, lambda=2.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:33:26,410 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:26,446 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:26,482 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:26,484 - INFO - 
[58/2560] exp_0058_eps0.010_rho0.01_lam2.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:33:26,485 - INFO -   eps=0.010, rho=0.01, lambda=2.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:33:26,519 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:26,556 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:26,592 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:26,593 - INFO - 
[59/2560] exp_0059_eps0.010_rho0.01_lam2.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:33:26,594 - INFO -   eps=0.010, rho=0.01, lambda=2.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:33:26,632 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:26,666 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:26,702 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:26,704 - INFO - 
[60/2560] exp_0060_eps0.010_rho0.01_lam2.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:33:26,704 - INFO -   eps=0.010, rho=0.01, lambda=2.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:33:26,743 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:26,779 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:26,832 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:26,834 - INFO - 
[61/2560] exp_0061_eps0.010_rho0.01_lam2.5_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:33:26,834 - INFO -   eps=0.010, rho=0.01, lambda=2.5, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:33:26,891 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:26,948 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:27,005 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:27,008 - INFO - 
[62/2560] exp_0062_eps0.010_rho0.01_lam2.5_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:33:27,008 - INFO -   eps=0.010, rho=0.01, lambda=2.5, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:33:27,064 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:27,120 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:27,176 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:27,178 - INFO - 
[63/2560] exp_0063_eps0.010_rho0.01_lam2.5_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:33:27,178 - INFO -   eps=0.010, rho=0.01, lambda=2.5, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:33:27,234 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:27,290 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:27,347 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:27,350 - INFO - 
[64/2560] exp_0064_eps0.010_rho0.01_lam2.5_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:33:27,350 - INFO -   eps=0.010, rho=0.01, lambda=2.5, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:33:27,405 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:27,462 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:27,519 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:27,522 - INFO - 
[65/2560] exp_0065_eps0.010_rho0.01_lam3.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:33:27,522 - INFO -   eps=0.010, rho=0.01, lambda=3.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:33:27,577 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:27,636 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:27,691 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:27,693 - INFO - 
[66/2560] exp_0066_eps0.010_rho0.01_lam3.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:33:27,694 - INFO -   eps=0.010, rho=0.01, lambda=3.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:33:27,758 - INFO -   Cloud sizes: source=157094, target=155837
2025-12-05 23:33:27,820 - WARNING -   OOM error during Sinkhorn computation. Clearing cache and retrying...
2025-12-05 23:33:27,878 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 111, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 232, in run_ablation_studies
    transport_data = interpolator.compute_transport_plan(img_source, img_target)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 119, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 208.00 MiB memory in use. Of the allocated memory 11.94 MiB is allocated by PyTorch, and 12.06 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:33:27,881 - INFO - 
[67/2560] exp_0067_eps0.010_rho0.01_lam3.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:33:27,881 - INFO -   eps=0.010, rho=0.01, lambda=3.0, debias=False, dyn_rast=True, adapt_sigma=False
