2025-12-05 23:32:37,102 - INFO - ================================================================================
2025-12-05 23:32:37,102 - INFO - DÉMARRAGE DES ÉTUDES D'ABLATION
2025-12-05 23:32:37,102 - INFO - ================================================================================
2025-12-05 23:32:37,102 - INFO - Loading images...
2025-12-05 23:32:37,272 - INFO - Source: torch.Size([3, 458, 343]), Target: torch.Size([3, 457, 341])
2025-12-05 23:32:37,272 - INFO - Using native resolutions: source=458x343, target=457x341
2025-12-05 23:32:37,272 - INFO - Resolution config: (458, 457)
2025-12-05 23:32:37,272 - INFO - Nombre total d'expériences: 2560
2025-12-05 23:32:37,272 - INFO - Lambda values: [0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 10.0, 50.0, 100.0]
2025-12-05 23:32:37,272 - INFO - 
[1/2560] exp_0001_eps0.010_rhobalanced_lam0.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:37,273 - INFO -   eps=0.010, rho=None, lambda=0.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:37,431 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,434 - INFO - 
[2/2560] exp_0002_eps0.010_rhobalanced_lam0.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:37,434 - INFO -   eps=0.010, rho=None, lambda=0.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:37,437 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,438 - INFO - 
[3/2560] exp_0003_eps0.010_rhobalanced_lam0.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:37,439 - INFO -   eps=0.010, rho=None, lambda=0.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:37,442 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,444 - INFO - 
[4/2560] exp_0004_eps0.010_rhobalanced_lam0.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:37,444 - INFO -   eps=0.010, rho=None, lambda=0.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:37,447 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,448 - INFO - 
[5/2560] exp_0005_eps0.010_rhobalanced_lam0.5_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:37,448 - INFO -   eps=0.010, rho=None, lambda=0.5, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:37,451 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,452 - INFO - 
[6/2560] exp_0006_eps0.010_rhobalanced_lam0.5_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:37,452 - INFO -   eps=0.010, rho=None, lambda=0.5, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:37,456 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,457 - INFO - 
[7/2560] exp_0007_eps0.010_rhobalanced_lam0.5_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:37,457 - INFO -   eps=0.010, rho=None, lambda=0.5, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:37,460 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,461 - INFO - 
[8/2560] exp_0008_eps0.010_rhobalanced_lam0.5_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:37,461 - INFO -   eps=0.010, rho=None, lambda=0.5, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:37,464 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,465 - INFO - 
[9/2560] exp_0009_eps0.010_rhobalanced_lam1.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:37,465 - INFO -   eps=0.010, rho=None, lambda=1.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:37,469 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,470 - INFO - 
[10/2560] exp_0010_eps0.010_rhobalanced_lam1.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:37,470 - INFO -   eps=0.010, rho=None, lambda=1.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:37,473 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,474 - INFO - 
[11/2560] exp_0011_eps0.010_rhobalanced_lam1.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:37,474 - INFO -   eps=0.010, rho=None, lambda=1.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:37,477 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,478 - INFO - 
[12/2560] exp_0012_eps0.010_rhobalanced_lam1.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:37,478 - INFO -   eps=0.010, rho=None, lambda=1.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:37,481 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,482 - INFO - 
[13/2560] exp_0013_eps0.010_rhobalanced_lam1.5_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:37,482 - INFO -   eps=0.010, rho=None, lambda=1.5, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:37,485 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,487 - INFO - 
[14/2560] exp_0014_eps0.010_rhobalanced_lam1.5_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:37,487 - INFO -   eps=0.010, rho=None, lambda=1.5, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:37,490 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,491 - INFO - 
[15/2560] exp_0015_eps0.010_rhobalanced_lam1.5_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:37,491 - INFO -   eps=0.010, rho=None, lambda=1.5, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:37,494 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,495 - INFO - 
[16/2560] exp_0016_eps0.010_rhobalanced_lam1.5_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:37,495 - INFO -   eps=0.010, rho=None, lambda=1.5, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:37,498 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,500 - INFO - 
[17/2560] exp_0017_eps0.010_rhobalanced_lam2.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:37,500 - INFO -   eps=0.010, rho=None, lambda=2.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:37,503 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,504 - INFO - 
[18/2560] exp_0018_eps0.010_rhobalanced_lam2.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:37,504 - INFO -   eps=0.010, rho=None, lambda=2.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:37,508 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,509 - INFO - 
[19/2560] exp_0019_eps0.010_rhobalanced_lam2.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:37,509 - INFO -   eps=0.010, rho=None, lambda=2.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:37,512 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,513 - INFO - 
[20/2560] exp_0020_eps0.010_rhobalanced_lam2.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:37,513 - INFO -   eps=0.010, rho=None, lambda=2.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:37,516 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,517 - INFO - 
[21/2560] exp_0021_eps0.010_rhobalanced_lam2.5_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:37,517 - INFO -   eps=0.010, rho=None, lambda=2.5, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:37,520 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,521 - INFO - 
[22/2560] exp_0022_eps0.010_rhobalanced_lam2.5_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:37,522 - INFO -   eps=0.010, rho=None, lambda=2.5, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:37,525 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,526 - INFO - 
[23/2560] exp_0023_eps0.010_rhobalanced_lam2.5_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:37,526 - INFO -   eps=0.010, rho=None, lambda=2.5, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:37,529 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,530 - INFO - 
[24/2560] exp_0024_eps0.010_rhobalanced_lam2.5_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:37,530 - INFO -   eps=0.010, rho=None, lambda=2.5, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:37,534 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,535 - INFO - 
[25/2560] exp_0025_eps0.010_rhobalanced_lam3.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:37,535 - INFO -   eps=0.010, rho=None, lambda=3.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:37,538 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,540 - INFO - 
[26/2560] exp_0026_eps0.010_rhobalanced_lam3.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:37,540 - INFO -   eps=0.010, rho=None, lambda=3.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:37,543 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,544 - INFO - 
[27/2560] exp_0027_eps0.010_rhobalanced_lam3.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:37,544 - INFO -   eps=0.010, rho=None, lambda=3.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:37,547 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,548 - INFO - 
[28/2560] exp_0028_eps0.010_rhobalanced_lam3.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:37,549 - INFO -   eps=0.010, rho=None, lambda=3.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:37,552 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,553 - INFO - 
[29/2560] exp_0029_eps0.010_rhobalanced_lam10_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:37,553 - INFO -   eps=0.010, rho=None, lambda=10.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:37,556 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,557 - INFO - 
[30/2560] exp_0030_eps0.010_rhobalanced_lam10_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:37,557 - INFO -   eps=0.010, rho=None, lambda=10.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:37,561 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,562 - INFO - 
[31/2560] exp_0031_eps0.010_rhobalanced_lam10_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:37,562 - INFO -   eps=0.010, rho=None, lambda=10.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:37,566 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,567 - INFO - 
[32/2560] exp_0032_eps0.010_rhobalanced_lam10_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:37,567 - INFO -   eps=0.010, rho=None, lambda=10.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:37,570 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,572 - INFO - 
[33/2560] exp_0033_eps0.010_rhobalanced_lam50_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:37,572 - INFO -   eps=0.010, rho=None, lambda=50.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:37,575 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,576 - INFO - 
[34/2560] exp_0034_eps0.010_rhobalanced_lam50_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:37,576 - INFO -   eps=0.010, rho=None, lambda=50.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:37,579 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,580 - INFO - 
[35/2560] exp_0035_eps0.010_rhobalanced_lam50_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:37,581 - INFO -   eps=0.010, rho=None, lambda=50.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:37,584 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,585 - INFO - 
[36/2560] exp_0036_eps0.010_rhobalanced_lam50_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:37,585 - INFO -   eps=0.010, rho=None, lambda=50.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:37,588 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,589 - INFO - 
[37/2560] exp_0037_eps0.010_rhobalanced_lam100_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:37,589 - INFO -   eps=0.010, rho=None, lambda=100.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:37,592 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,593 - INFO - 
[38/2560] exp_0038_eps0.010_rhobalanced_lam100_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:37,594 - INFO -   eps=0.010, rho=None, lambda=100.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:37,597 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,598 - INFO - 
[39/2560] exp_0039_eps0.010_rhobalanced_lam100_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:37,599 - INFO -   eps=0.010, rho=None, lambda=100.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:37,602 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,603 - INFO - 
[40/2560] exp_0040_eps0.010_rhobalanced_lam100_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:37,603 - INFO -   eps=0.010, rho=None, lambda=100.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:37,606 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,606 - INFO - 
[41/2560] exp_0041_eps0.010_rho0.01_lam0.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:37,607 - INFO -   eps=0.010, rho=0.01, lambda=0.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:37,609 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,610 - INFO - 
[42/2560] exp_0042_eps0.010_rho0.01_lam0.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:37,610 - INFO -   eps=0.010, rho=0.01, lambda=0.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:37,613 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,613 - INFO - 
[43/2560] exp_0043_eps0.010_rho0.01_lam0.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:37,613 - INFO -   eps=0.010, rho=0.01, lambda=0.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:37,616 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,617 - INFO - 
[44/2560] exp_0044_eps0.010_rho0.01_lam0.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:37,617 - INFO -   eps=0.010, rho=0.01, lambda=0.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:37,620 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,620 - INFO - 
[45/2560] exp_0045_eps0.010_rho0.01_lam0.5_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:37,620 - INFO -   eps=0.010, rho=0.01, lambda=0.5, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:37,624 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,626 - INFO - 
[46/2560] exp_0046_eps0.010_rho0.01_lam0.5_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:37,626 - INFO -   eps=0.010, rho=0.01, lambda=0.5, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:37,629 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,642 - INFO - 
[47/2560] exp_0047_eps0.010_rho0.01_lam0.5_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:37,642 - INFO -   eps=0.010, rho=0.01, lambda=0.5, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:37,646 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,646 - INFO - 
[48/2560] exp_0048_eps0.010_rho0.01_lam0.5_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:37,646 - INFO -   eps=0.010, rho=0.01, lambda=0.5, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:37,649 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,650 - INFO - 
[49/2560] exp_0049_eps0.010_rho0.01_lam1.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:37,650 - INFO -   eps=0.010, rho=0.01, lambda=1.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:37,653 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,666 - INFO - 
[50/2560] exp_0050_eps0.010_rho0.01_lam1.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:37,666 - INFO -   eps=0.010, rho=0.01, lambda=1.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:37,670 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,670 - INFO - 
[51/2560] exp_0051_eps0.010_rho0.01_lam1.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:37,670 - INFO -   eps=0.010, rho=0.01, lambda=1.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:37,673 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,674 - INFO - 
[52/2560] exp_0052_eps0.010_rho0.01_lam1.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:37,674 - INFO -   eps=0.010, rho=0.01, lambda=1.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:37,677 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,677 - INFO - 
[53/2560] exp_0053_eps0.010_rho0.01_lam1.5_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:37,678 - INFO -   eps=0.010, rho=0.01, lambda=1.5, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:37,680 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,690 - INFO - 
[54/2560] exp_0054_eps0.010_rho0.01_lam1.5_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:37,690 - INFO -   eps=0.010, rho=0.01, lambda=1.5, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:37,693 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,694 - INFO - 
[55/2560] exp_0055_eps0.010_rho0.01_lam1.5_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:37,694 - INFO -   eps=0.010, rho=0.01, lambda=1.5, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:37,697 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,697 - INFO - 
[56/2560] exp_0056_eps0.010_rho0.01_lam1.5_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:37,697 - INFO -   eps=0.010, rho=0.01, lambda=1.5, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:37,700 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,701 - INFO - 
[57/2560] exp_0057_eps0.010_rho0.01_lam2.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:37,701 - INFO -   eps=0.010, rho=0.01, lambda=2.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:37,717 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,718 - INFO - 
[58/2560] exp_0058_eps0.010_rho0.01_lam2.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:37,718 - INFO -   eps=0.010, rho=0.01, lambda=2.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:37,721 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,721 - INFO - 
[59/2560] exp_0059_eps0.010_rho0.01_lam2.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:37,721 - INFO -   eps=0.010, rho=0.01, lambda=2.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:37,724 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,725 - INFO - 
[60/2560] exp_0060_eps0.010_rho0.01_lam2.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:37,725 - INFO -   eps=0.010, rho=0.01, lambda=2.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:37,728 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,742 - INFO - 
[61/2560] exp_0061_eps0.010_rho0.01_lam2.5_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:37,742 - INFO -   eps=0.010, rho=0.01, lambda=2.5, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:37,745 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,745 - INFO - 
[62/2560] exp_0062_eps0.010_rho0.01_lam2.5_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:37,745 - INFO -   eps=0.010, rho=0.01, lambda=2.5, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:37,748 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,749 - INFO - 
[63/2560] exp_0063_eps0.010_rho0.01_lam2.5_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:37,749 - INFO -   eps=0.010, rho=0.01, lambda=2.5, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:37,752 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,753 - INFO - 
[64/2560] exp_0064_eps0.010_rho0.01_lam2.5_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:37,753 - INFO -   eps=0.010, rho=0.01, lambda=2.5, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:37,769 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,782 - INFO - 
[65/2560] exp_0065_eps0.010_rho0.01_lam3.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:37,782 - INFO -   eps=0.010, rho=0.01, lambda=3.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:37,786 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,786 - INFO - 
[66/2560] exp_0066_eps0.010_rho0.01_lam3.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:37,786 - INFO -   eps=0.010, rho=0.01, lambda=3.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:37,789 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,790 - INFO - 
[67/2560] exp_0067_eps0.010_rho0.01_lam3.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:37,790 - INFO -   eps=0.010, rho=0.01, lambda=3.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:37,793 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,793 - INFO - 
[68/2560] exp_0068_eps0.010_rho0.01_lam3.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:37,793 - INFO -   eps=0.010, rho=0.01, lambda=3.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:37,796 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,809 - INFO - 
[69/2560] exp_0069_eps0.010_rho0.01_lam10_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:37,809 - INFO -   eps=0.010, rho=0.01, lambda=10.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:37,812 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,813 - INFO - 
[70/2560] exp_0070_eps0.010_rho0.01_lam10_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:37,813 - INFO -   eps=0.010, rho=0.01, lambda=10.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:37,816 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,817 - INFO - 
[71/2560] exp_0071_eps0.010_rho0.01_lam10_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:37,817 - INFO -   eps=0.010, rho=0.01, lambda=10.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:37,819 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,820 - INFO - 
[72/2560] exp_0072_eps0.010_rho0.01_lam10_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:37,820 - INFO -   eps=0.010, rho=0.01, lambda=10.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:37,823 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,836 - INFO - 
[73/2560] exp_0073_eps0.010_rho0.01_lam50_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:37,836 - INFO -   eps=0.010, rho=0.01, lambda=50.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:37,839 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,840 - INFO - 
[74/2560] exp_0074_eps0.010_rho0.01_lam50_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:37,840 - INFO -   eps=0.010, rho=0.01, lambda=50.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:37,843 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,844 - INFO - 
[75/2560] exp_0075_eps0.010_rho0.01_lam50_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:37,844 - INFO -   eps=0.010, rho=0.01, lambda=50.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:37,847 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,848 - INFO - 
[76/2560] exp_0076_eps0.010_rho0.01_lam50_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:37,848 - INFO -   eps=0.010, rho=0.01, lambda=50.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:37,851 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,852 - INFO - 
[77/2560] exp_0077_eps0.010_rho0.01_lam100_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:37,852 - INFO -   eps=0.010, rho=0.01, lambda=100.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:37,855 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,856 - INFO - 
[78/2560] exp_0078_eps0.010_rho0.01_lam100_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:37,856 - INFO -   eps=0.010, rho=0.01, lambda=100.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:37,859 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,860 - INFO - 
[79/2560] exp_0079_eps0.010_rho0.01_lam100_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:37,861 - INFO -   eps=0.010, rho=0.01, lambda=100.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:37,864 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,865 - INFO - 
[80/2560] exp_0080_eps0.010_rho0.01_lam100_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:37,865 - INFO -   eps=0.010, rho=0.01, lambda=100.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:37,868 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,869 - INFO - 
[81/2560] exp_0081_eps0.010_rho0.02_lam0.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:37,869 - INFO -   eps=0.010, rho=0.02, lambda=0.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:37,872 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,873 - INFO - 
[82/2560] exp_0082_eps0.010_rho0.02_lam0.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:37,873 - INFO -   eps=0.010, rho=0.02, lambda=0.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:37,876 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,877 - INFO - 
[83/2560] exp_0083_eps0.010_rho0.02_lam0.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:37,878 - INFO -   eps=0.010, rho=0.02, lambda=0.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:37,881 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,882 - INFO - 
[84/2560] exp_0084_eps0.010_rho0.02_lam0.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:37,882 - INFO -   eps=0.010, rho=0.02, lambda=0.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:37,885 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,886 - INFO - 
[85/2560] exp_0085_eps0.010_rho0.02_lam0.5_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:37,886 - INFO -   eps=0.010, rho=0.02, lambda=0.5, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:37,889 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,890 - INFO - 
[86/2560] exp_0086_eps0.010_rho0.02_lam0.5_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:37,890 - INFO -   eps=0.010, rho=0.02, lambda=0.5, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:37,893 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,894 - INFO - 
[87/2560] exp_0087_eps0.010_rho0.02_lam0.5_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:37,894 - INFO -   eps=0.010, rho=0.02, lambda=0.5, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:37,898 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,899 - INFO - 
[88/2560] exp_0088_eps0.010_rho0.02_lam0.5_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:37,899 - INFO -   eps=0.010, rho=0.02, lambda=0.5, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:37,902 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,903 - INFO - 
[89/2560] exp_0089_eps0.010_rho0.02_lam1.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:37,903 - INFO -   eps=0.010, rho=0.02, lambda=1.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:37,906 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,907 - INFO - 
[90/2560] exp_0090_eps0.010_rho0.02_lam1.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:37,907 - INFO -   eps=0.010, rho=0.02, lambda=1.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:37,910 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,912 - INFO - 
[91/2560] exp_0091_eps0.010_rho0.02_lam1.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:37,912 - INFO -   eps=0.010, rho=0.02, lambda=1.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:37,915 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,916 - INFO - 
[92/2560] exp_0092_eps0.010_rho0.02_lam1.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:37,916 - INFO -   eps=0.010, rho=0.02, lambda=1.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:37,919 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,920 - INFO - 
[93/2560] exp_0093_eps0.010_rho0.02_lam1.5_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:37,920 - INFO -   eps=0.010, rho=0.02, lambda=1.5, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:37,924 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,925 - INFO - 
[94/2560] exp_0094_eps0.010_rho0.02_lam1.5_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:37,925 - INFO -   eps=0.010, rho=0.02, lambda=1.5, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:37,928 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,929 - INFO - 
[95/2560] exp_0095_eps0.010_rho0.02_lam1.5_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:37,929 - INFO -   eps=0.010, rho=0.02, lambda=1.5, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:37,932 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,933 - INFO - 
[96/2560] exp_0096_eps0.010_rho0.02_lam1.5_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:37,933 - INFO -   eps=0.010, rho=0.02, lambda=1.5, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:37,936 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,937 - INFO - 
[97/2560] exp_0097_eps0.010_rho0.02_lam2.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:37,937 - INFO -   eps=0.010, rho=0.02, lambda=2.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:37,940 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,941 - INFO - 
[98/2560] exp_0098_eps0.010_rho0.02_lam2.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:37,941 - INFO -   eps=0.010, rho=0.02, lambda=2.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:37,944 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,946 - INFO - 
[99/2560] exp_0099_eps0.010_rho0.02_lam2.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:37,946 - INFO -   eps=0.010, rho=0.02, lambda=2.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:37,949 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,950 - INFO - 
[100/2560] exp_0100_eps0.010_rho0.02_lam2.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:37,950 - INFO -   eps=0.010, rho=0.02, lambda=2.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:37,953 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,954 - INFO - 
[101/2560] exp_0101_eps0.010_rho0.02_lam2.5_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:37,954 - INFO -   eps=0.010, rho=0.02, lambda=2.5, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:37,957 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,958 - INFO - 
[102/2560] exp_0102_eps0.010_rho0.02_lam2.5_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:37,958 - INFO -   eps=0.010, rho=0.02, lambda=2.5, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:37,961 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,962 - INFO - 
[103/2560] exp_0103_eps0.010_rho0.02_lam2.5_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:37,962 - INFO -   eps=0.010, rho=0.02, lambda=2.5, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:37,966 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,967 - INFO - 
[104/2560] exp_0104_eps0.010_rho0.02_lam2.5_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:37,967 - INFO -   eps=0.010, rho=0.02, lambda=2.5, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:37,970 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,971 - INFO - 
[105/2560] exp_0105_eps0.010_rho0.02_lam3.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:37,971 - INFO -   eps=0.010, rho=0.02, lambda=3.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:37,974 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,977 - INFO - 
[106/2560] exp_0106_eps0.010_rho0.02_lam3.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:37,977 - INFO -   eps=0.010, rho=0.02, lambda=3.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:37,980 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,987 - INFO - 
[107/2560] exp_0107_eps0.010_rho0.02_lam3.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:37,987 - INFO -   eps=0.010, rho=0.02, lambda=3.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:37,990 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,991 - INFO - 
[108/2560] exp_0108_eps0.010_rho0.02_lam3.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:37,991 - INFO -   eps=0.010, rho=0.02, lambda=3.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:37,995 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:37,996 - INFO - 
[109/2560] exp_0109_eps0.010_rho0.02_lam10_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:37,996 - INFO -   eps=0.010, rho=0.02, lambda=10.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:37,999 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,000 - INFO - 
[110/2560] exp_0110_eps0.010_rho0.02_lam10_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:38,000 - INFO -   eps=0.010, rho=0.02, lambda=10.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:38,003 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,004 - INFO - 
[111/2560] exp_0111_eps0.010_rho0.02_lam10_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:38,004 - INFO -   eps=0.010, rho=0.02, lambda=10.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:38,008 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,009 - INFO - 
[112/2560] exp_0112_eps0.010_rho0.02_lam10_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:38,009 - INFO -   eps=0.010, rho=0.02, lambda=10.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:38,012 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,013 - INFO - 
[113/2560] exp_0113_eps0.010_rho0.02_lam50_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:38,013 - INFO -   eps=0.010, rho=0.02, lambda=50.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:38,016 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,017 - INFO - 
[114/2560] exp_0114_eps0.010_rho0.02_lam50_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:38,017 - INFO -   eps=0.010, rho=0.02, lambda=50.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:38,020 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,021 - INFO - 
[115/2560] exp_0115_eps0.010_rho0.02_lam50_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:38,021 - INFO -   eps=0.010, rho=0.02, lambda=50.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:38,024 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,025 - INFO - 
[116/2560] exp_0116_eps0.010_rho0.02_lam50_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:38,025 - INFO -   eps=0.010, rho=0.02, lambda=50.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:38,029 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,030 - INFO - 
[117/2560] exp_0117_eps0.010_rho0.02_lam100_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:38,030 - INFO -   eps=0.010, rho=0.02, lambda=100.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:38,033 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,034 - INFO - 
[118/2560] exp_0118_eps0.010_rho0.02_lam100_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:38,034 - INFO -   eps=0.010, rho=0.02, lambda=100.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:38,037 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,038 - INFO - 
[119/2560] exp_0119_eps0.010_rho0.02_lam100_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:38,038 - INFO -   eps=0.010, rho=0.02, lambda=100.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:38,041 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,042 - INFO - 
[120/2560] exp_0120_eps0.010_rho0.02_lam100_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:38,042 - INFO -   eps=0.010, rho=0.02, lambda=100.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:38,045 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,046 - INFO - 
[121/2560] exp_0121_eps0.010_rho0.05_lam0.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:38,046 - INFO -   eps=0.010, rho=0.05, lambda=0.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:38,050 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,050 - INFO - 
[122/2560] exp_0122_eps0.010_rho0.05_lam0.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:38,051 - INFO -   eps=0.010, rho=0.05, lambda=0.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:38,053 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,054 - INFO - 
[123/2560] exp_0123_eps0.010_rho0.05_lam0.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:38,055 - INFO -   eps=0.010, rho=0.05, lambda=0.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:38,058 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,059 - INFO - 
[124/2560] exp_0124_eps0.010_rho0.05_lam0.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:38,059 - INFO -   eps=0.010, rho=0.05, lambda=0.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:38,062 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,063 - INFO - 
[125/2560] exp_0125_eps0.010_rho0.05_lam0.5_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:38,063 - INFO -   eps=0.010, rho=0.05, lambda=0.5, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:38,066 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,067 - INFO - 
[126/2560] exp_0126_eps0.010_rho0.05_lam0.5_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:38,067 - INFO -   eps=0.010, rho=0.05, lambda=0.5, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:38,069 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,070 - INFO - 
[127/2560] exp_0127_eps0.010_rho0.05_lam0.5_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:38,070 - INFO -   eps=0.010, rho=0.05, lambda=0.5, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:38,073 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,074 - INFO - 
[128/2560] exp_0128_eps0.010_rho0.05_lam0.5_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:38,074 - INFO -   eps=0.010, rho=0.05, lambda=0.5, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:38,077 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,078 - INFO - 
[129/2560] exp_0129_eps0.010_rho0.05_lam1.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:38,078 - INFO -   eps=0.010, rho=0.05, lambda=1.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:38,080 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,081 - INFO - 
[130/2560] exp_0130_eps0.010_rho0.05_lam1.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:38,081 - INFO -   eps=0.010, rho=0.05, lambda=1.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:38,084 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,084 - INFO - 
[131/2560] exp_0131_eps0.010_rho0.05_lam1.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:38,084 - INFO -   eps=0.010, rho=0.05, lambda=1.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:38,087 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,088 - INFO - 
[132/2560] exp_0132_eps0.010_rho0.05_lam1.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:38,088 - INFO -   eps=0.010, rho=0.05, lambda=1.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:38,091 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,091 - INFO - 
[133/2560] exp_0133_eps0.010_rho0.05_lam1.5_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:38,091 - INFO -   eps=0.010, rho=0.05, lambda=1.5, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:38,094 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,223 - INFO - 
[134/2560] exp_0134_eps0.010_rho0.05_lam1.5_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:38,223 - INFO -   eps=0.010, rho=0.05, lambda=1.5, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:38,226 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,229 - INFO - 
[135/2560] exp_0135_eps0.010_rho0.05_lam1.5_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:38,230 - INFO -   eps=0.010, rho=0.05, lambda=1.5, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:38,233 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,234 - INFO - 
[136/2560] exp_0136_eps0.010_rho0.05_lam1.5_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:38,234 - INFO -   eps=0.010, rho=0.05, lambda=1.5, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:38,237 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,239 - INFO - 
[137/2560] exp_0137_eps0.010_rho0.05_lam2.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:38,239 - INFO -   eps=0.010, rho=0.05, lambda=2.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:38,242 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,244 - INFO - 
[138/2560] exp_0138_eps0.010_rho0.05_lam2.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:38,244 - INFO -   eps=0.010, rho=0.05, lambda=2.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:38,248 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,249 - INFO - 
[139/2560] exp_0139_eps0.010_rho0.05_lam2.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:38,250 - INFO -   eps=0.010, rho=0.05, lambda=2.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:38,253 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,254 - INFO - 
[140/2560] exp_0140_eps0.010_rho0.05_lam2.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:38,254 - INFO -   eps=0.010, rho=0.05, lambda=2.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:38,258 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,258 - INFO - 
[141/2560] exp_0141_eps0.010_rho0.05_lam2.5_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:38,258 - INFO -   eps=0.010, rho=0.05, lambda=2.5, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:38,261 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,262 - INFO - 
[142/2560] exp_0142_eps0.010_rho0.05_lam2.5_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:38,262 - INFO -   eps=0.010, rho=0.05, lambda=2.5, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:38,265 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,265 - INFO - 
[143/2560] exp_0143_eps0.010_rho0.05_lam2.5_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:38,265 - INFO -   eps=0.010, rho=0.05, lambda=2.5, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:38,268 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,269 - INFO - 
[144/2560] exp_0144_eps0.010_rho0.05_lam2.5_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:38,269 - INFO -   eps=0.010, rho=0.05, lambda=2.5, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:38,272 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,272 - INFO - 
[145/2560] exp_0145_eps0.010_rho0.05_lam3.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:38,272 - INFO -   eps=0.010, rho=0.05, lambda=3.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:38,276 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,276 - INFO - 
[146/2560] exp_0146_eps0.010_rho0.05_lam3.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:38,276 - INFO -   eps=0.010, rho=0.05, lambda=3.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:38,279 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,280 - INFO - 
[147/2560] exp_0147_eps0.010_rho0.05_lam3.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:38,280 - INFO -   eps=0.010, rho=0.05, lambda=3.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:38,283 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,284 - INFO - 
[148/2560] exp_0148_eps0.010_rho0.05_lam3.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:38,284 - INFO -   eps=0.010, rho=0.05, lambda=3.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:38,287 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,288 - INFO - 
[149/2560] exp_0149_eps0.010_rho0.05_lam10_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:38,288 - INFO -   eps=0.010, rho=0.05, lambda=10.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:38,291 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,292 - INFO - 
[150/2560] exp_0150_eps0.010_rho0.05_lam10_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:38,292 - INFO -   eps=0.010, rho=0.05, lambda=10.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:38,295 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,296 - INFO - 
[151/2560] exp_0151_eps0.010_rho0.05_lam10_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:38,296 - INFO -   eps=0.010, rho=0.05, lambda=10.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:38,299 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,300 - INFO - 
[152/2560] exp_0152_eps0.010_rho0.05_lam10_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:38,301 - INFO -   eps=0.010, rho=0.05, lambda=10.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:38,304 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,307 - INFO - 
[153/2560] exp_0153_eps0.010_rho0.05_lam50_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:38,308 - INFO -   eps=0.010, rho=0.05, lambda=50.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:38,311 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,312 - INFO - 
[154/2560] exp_0154_eps0.010_rho0.05_lam50_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:38,312 - INFO -   eps=0.010, rho=0.05, lambda=50.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:38,315 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,316 - INFO - 
[155/2560] exp_0155_eps0.010_rho0.05_lam50_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:38,316 - INFO -   eps=0.010, rho=0.05, lambda=50.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:38,319 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,320 - INFO - 
[156/2560] exp_0156_eps0.010_rho0.05_lam50_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:38,320 - INFO -   eps=0.010, rho=0.05, lambda=50.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:38,324 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,325 - INFO - 
[157/2560] exp_0157_eps0.010_rho0.05_lam100_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:38,325 - INFO -   eps=0.010, rho=0.05, lambda=100.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:38,328 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,329 - INFO - 
[158/2560] exp_0158_eps0.010_rho0.05_lam100_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:38,329 - INFO -   eps=0.010, rho=0.05, lambda=100.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:38,332 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,334 - INFO - 
[159/2560] exp_0159_eps0.010_rho0.05_lam100_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:38,334 - INFO -   eps=0.010, rho=0.05, lambda=100.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:38,337 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,338 - INFO - 
[160/2560] exp_0160_eps0.010_rho0.05_lam100_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:38,338 - INFO -   eps=0.010, rho=0.05, lambda=100.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:38,342 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,343 - INFO - 
[161/2560] exp_0161_eps0.010_rho0.10_lam0.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:38,343 - INFO -   eps=0.010, rho=0.1, lambda=0.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:38,346 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,347 - INFO - 
[162/2560] exp_0162_eps0.010_rho0.10_lam0.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:38,347 - INFO -   eps=0.010, rho=0.1, lambda=0.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:38,350 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,351 - INFO - 
[163/2560] exp_0163_eps0.010_rho0.10_lam0.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:38,351 - INFO -   eps=0.010, rho=0.1, lambda=0.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:38,354 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,355 - INFO - 
[164/2560] exp_0164_eps0.010_rho0.10_lam0.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:38,356 - INFO -   eps=0.010, rho=0.1, lambda=0.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:38,359 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,360 - INFO - 
[165/2560] exp_0165_eps0.010_rho0.10_lam0.5_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:38,360 - INFO -   eps=0.010, rho=0.1, lambda=0.5, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:38,363 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,364 - INFO - 
[166/2560] exp_0166_eps0.010_rho0.10_lam0.5_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:38,364 - INFO -   eps=0.010, rho=0.1, lambda=0.5, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:38,367 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,368 - INFO - 
[167/2560] exp_0167_eps0.010_rho0.10_lam0.5_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:38,368 - INFO -   eps=0.010, rho=0.1, lambda=0.5, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:38,372 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,373 - INFO - 
[168/2560] exp_0168_eps0.010_rho0.10_lam0.5_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:38,373 - INFO -   eps=0.010, rho=0.1, lambda=0.5, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:38,376 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,377 - INFO - 
[169/2560] exp_0169_eps0.010_rho0.10_lam1.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:38,377 - INFO -   eps=0.010, rho=0.1, lambda=1.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:38,380 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,381 - INFO - 
[170/2560] exp_0170_eps0.010_rho0.10_lam1.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:38,381 - INFO -   eps=0.010, rho=0.1, lambda=1.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:38,384 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,385 - INFO - 
[171/2560] exp_0171_eps0.010_rho0.10_lam1.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:38,385 - INFO -   eps=0.010, rho=0.1, lambda=1.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:38,388 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,389 - INFO - 
[172/2560] exp_0172_eps0.010_rho0.10_lam1.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:38,390 - INFO -   eps=0.010, rho=0.1, lambda=1.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:38,393 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,394 - INFO - 
[173/2560] exp_0173_eps0.010_rho0.10_lam1.5_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:38,394 - INFO -   eps=0.010, rho=0.1, lambda=1.5, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:38,397 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,398 - INFO - 
[174/2560] exp_0174_eps0.010_rho0.10_lam1.5_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:38,398 - INFO -   eps=0.010, rho=0.1, lambda=1.5, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:38,401 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,402 - INFO - 
[175/2560] exp_0175_eps0.010_rho0.10_lam1.5_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:38,402 - INFO -   eps=0.010, rho=0.1, lambda=1.5, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:38,406 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,406 - INFO - 
[176/2560] exp_0176_eps0.010_rho0.10_lam1.5_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:38,406 - INFO -   eps=0.010, rho=0.1, lambda=1.5, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:38,409 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,410 - INFO - 
[177/2560] exp_0177_eps0.010_rho0.10_lam2.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:38,410 - INFO -   eps=0.010, rho=0.1, lambda=2.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:38,414 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,414 - INFO - 
[178/2560] exp_0178_eps0.010_rho0.10_lam2.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:38,415 - INFO -   eps=0.010, rho=0.1, lambda=2.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:38,418 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,418 - INFO - 
[179/2560] exp_0179_eps0.010_rho0.10_lam2.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:38,419 - INFO -   eps=0.010, rho=0.1, lambda=2.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:38,422 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,423 - INFO - 
[180/2560] exp_0180_eps0.010_rho0.10_lam2.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:38,423 - INFO -   eps=0.010, rho=0.1, lambda=2.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:38,426 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,426 - INFO - 
[181/2560] exp_0181_eps0.010_rho0.10_lam2.5_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:38,426 - INFO -   eps=0.010, rho=0.1, lambda=2.5, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:38,429 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,430 - INFO - 
[182/2560] exp_0182_eps0.010_rho0.10_lam2.5_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:38,430 - INFO -   eps=0.010, rho=0.1, lambda=2.5, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:38,433 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,433 - INFO - 
[183/2560] exp_0183_eps0.010_rho0.10_lam2.5_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:38,433 - INFO -   eps=0.010, rho=0.1, lambda=2.5, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:38,437 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,438 - INFO - 
[184/2560] exp_0184_eps0.010_rho0.10_lam2.5_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:38,438 - INFO -   eps=0.010, rho=0.1, lambda=2.5, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:38,440 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,441 - INFO - 
[185/2560] exp_0185_eps0.010_rho0.10_lam3.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:38,441 - INFO -   eps=0.010, rho=0.1, lambda=3.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:38,444 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,444 - INFO - 
[186/2560] exp_0186_eps0.010_rho0.10_lam3.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:38,444 - INFO -   eps=0.010, rho=0.1, lambda=3.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:38,447 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,448 - INFO - 
[187/2560] exp_0187_eps0.010_rho0.10_lam3.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:38,448 - INFO -   eps=0.010, rho=0.1, lambda=3.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:38,451 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,451 - INFO - 
[188/2560] exp_0188_eps0.010_rho0.10_lam3.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:38,451 - INFO -   eps=0.010, rho=0.1, lambda=3.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:38,454 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,540 - INFO - 
[189/2560] exp_0189_eps0.010_rho0.10_lam10_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:38,541 - INFO -   eps=0.010, rho=0.1, lambda=10.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:38,544 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,545 - INFO - 
[190/2560] exp_0190_eps0.010_rho0.10_lam10_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:38,545 - INFO -   eps=0.010, rho=0.1, lambda=10.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:38,548 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,548 - INFO - 
[191/2560] exp_0191_eps0.010_rho0.10_lam10_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:38,548 - INFO -   eps=0.010, rho=0.1, lambda=10.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:38,551 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,552 - INFO - 
[192/2560] exp_0192_eps0.010_rho0.10_lam10_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:38,552 - INFO -   eps=0.010, rho=0.1, lambda=10.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:38,555 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,564 - INFO - 
[193/2560] exp_0193_eps0.010_rho0.10_lam50_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:38,564 - INFO -   eps=0.010, rho=0.1, lambda=50.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:38,567 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,568 - INFO - 
[194/2560] exp_0194_eps0.010_rho0.10_lam50_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:38,568 - INFO -   eps=0.010, rho=0.1, lambda=50.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:38,571 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,571 - INFO - 
[195/2560] exp_0195_eps0.010_rho0.10_lam50_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:38,571 - INFO -   eps=0.010, rho=0.1, lambda=50.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:38,574 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,575 - INFO - 
[196/2560] exp_0196_eps0.010_rho0.10_lam50_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:38,575 - INFO -   eps=0.010, rho=0.1, lambda=50.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:38,591 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,592 - INFO - 
[197/2560] exp_0197_eps0.010_rho0.10_lam100_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:38,592 - INFO -   eps=0.010, rho=0.1, lambda=100.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:38,595 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,595 - INFO - 
[198/2560] exp_0198_eps0.010_rho0.10_lam100_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:38,595 - INFO -   eps=0.010, rho=0.1, lambda=100.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:38,598 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,599 - INFO - 
[199/2560] exp_0199_eps0.010_rho0.10_lam100_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:38,599 - INFO -   eps=0.010, rho=0.1, lambda=100.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:38,602 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,615 - INFO - 
[200/2560] exp_0200_eps0.010_rho0.10_lam100_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:38,615 - INFO -   eps=0.010, rho=0.1, lambda=100.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:38,619 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,626 - INFO - 
[201/2560] exp_0201_eps0.010_rho0.15_lam0.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:38,626 - INFO -   eps=0.010, rho=0.15, lambda=0.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:38,629 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,629 - INFO - 
[202/2560] exp_0202_eps0.010_rho0.15_lam0.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:38,630 - INFO -   eps=0.010, rho=0.15, lambda=0.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:38,645 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,646 - INFO - 
[203/2560] exp_0203_eps0.010_rho0.15_lam0.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:38,646 - INFO -   eps=0.010, rho=0.15, lambda=0.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:38,649 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,650 - INFO - 
[204/2560] exp_0204_eps0.010_rho0.15_lam0.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:38,650 - INFO -   eps=0.010, rho=0.15, lambda=0.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:38,653 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,653 - INFO - 
[205/2560] exp_0205_eps0.010_rho0.15_lam0.5_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:38,653 - INFO -   eps=0.010, rho=0.15, lambda=0.5, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:38,656 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,669 - INFO - 
[206/2560] exp_0206_eps0.010_rho0.15_lam0.5_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:38,669 - INFO -   eps=0.010, rho=0.15, lambda=0.5, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:38,673 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,673 - INFO - 
[207/2560] exp_0207_eps0.010_rho0.15_lam0.5_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:38,673 - INFO -   eps=0.010, rho=0.15, lambda=0.5, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:38,676 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,677 - INFO - 
[208/2560] exp_0208_eps0.010_rho0.15_lam0.5_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:38,677 - INFO -   eps=0.010, rho=0.15, lambda=0.5, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:38,680 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,692 - INFO - 
[209/2560] exp_0209_eps0.010_rho0.15_lam1.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:38,692 - INFO -   eps=0.010, rho=0.15, lambda=1.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:38,696 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,696 - INFO - 
[210/2560] exp_0210_eps0.010_rho0.15_lam1.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:38,696 - INFO -   eps=0.010, rho=0.15, lambda=1.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:38,699 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,712 - INFO - 
[211/2560] exp_0211_eps0.010_rho0.15_lam1.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:38,712 - INFO -   eps=0.010, rho=0.15, lambda=1.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:38,716 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,716 - INFO - 
[212/2560] exp_0212_eps0.010_rho0.15_lam1.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:38,716 - INFO -   eps=0.010, rho=0.15, lambda=1.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:38,719 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,720 - INFO - 
[213/2560] exp_0213_eps0.010_rho0.15_lam1.5_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:38,720 - INFO -   eps=0.010, rho=0.15, lambda=1.5, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:38,723 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,723 - INFO - 
[214/2560] exp_0214_eps0.010_rho0.15_lam1.5_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:38,723 - INFO -   eps=0.010, rho=0.15, lambda=1.5, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:38,726 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,739 - INFO - 
[215/2560] exp_0215_eps0.010_rho0.15_lam1.5_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:38,739 - INFO -   eps=0.010, rho=0.15, lambda=1.5, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:38,743 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,743 - INFO - 
[216/2560] exp_0216_eps0.010_rho0.15_lam1.5_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:38,743 - INFO -   eps=0.010, rho=0.15, lambda=1.5, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:38,746 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,747 - INFO - 
[217/2560] exp_0217_eps0.010_rho0.15_lam2.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:38,747 - INFO -   eps=0.010, rho=0.15, lambda=2.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:38,750 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,763 - INFO - 
[218/2560] exp_0218_eps0.010_rho0.15_lam2.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:38,763 - INFO -   eps=0.010, rho=0.15, lambda=2.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:38,767 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,767 - INFO - 
[219/2560] exp_0219_eps0.010_rho0.15_lam2.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:38,767 - INFO -   eps=0.010, rho=0.15, lambda=2.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:38,770 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,771 - INFO - 
[220/2560] exp_0220_eps0.010_rho0.15_lam2.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:38,771 - INFO -   eps=0.010, rho=0.15, lambda=2.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:38,774 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,774 - INFO - 
[221/2560] exp_0221_eps0.010_rho0.15_lam2.5_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:38,775 - INFO -   eps=0.010, rho=0.15, lambda=2.5, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:38,777 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,790 - INFO - 
[222/2560] exp_0222_eps0.010_rho0.15_lam2.5_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:38,790 - INFO -   eps=0.010, rho=0.15, lambda=2.5, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:38,794 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,794 - INFO - 
[223/2560] exp_0223_eps0.010_rho0.15_lam2.5_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:38,794 - INFO -   eps=0.010, rho=0.15, lambda=2.5, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:38,797 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,798 - INFO - 
[224/2560] exp_0224_eps0.010_rho0.15_lam2.5_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:38,798 - INFO -   eps=0.010, rho=0.15, lambda=2.5, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:38,801 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,817 - INFO - 
[225/2560] exp_0225_eps0.010_rho0.15_lam3.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:38,817 - INFO -   eps=0.010, rho=0.15, lambda=3.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:38,821 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,821 - INFO - 
[226/2560] exp_0226_eps0.010_rho0.15_lam3.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:38,821 - INFO -   eps=0.010, rho=0.15, lambda=3.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:38,824 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,825 - INFO - 
[227/2560] exp_0227_eps0.010_rho0.15_lam3.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:38,825 - INFO -   eps=0.010, rho=0.15, lambda=3.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:38,844 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,845 - INFO - 
[228/2560] exp_0228_eps0.010_rho0.15_lam3.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:38,845 - INFO -   eps=0.010, rho=0.15, lambda=3.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:38,848 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,848 - INFO - 
[229/2560] exp_0229_eps0.010_rho0.15_lam10_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:38,848 - INFO -   eps=0.010, rho=0.15, lambda=10.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:38,851 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,852 - INFO - 
[230/2560] exp_0230_eps0.010_rho0.15_lam10_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:38,852 - INFO -   eps=0.010, rho=0.15, lambda=10.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:38,855 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,855 - INFO - 
[231/2560] exp_0231_eps0.010_rho0.15_lam10_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:38,864 - INFO -   eps=0.010, rho=0.15, lambda=10.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:38,867 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,867 - INFO - 
[232/2560] exp_0232_eps0.010_rho0.15_lam10_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:38,867 - INFO -   eps=0.010, rho=0.15, lambda=10.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:38,870 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,871 - INFO - 
[233/2560] exp_0233_eps0.010_rho0.15_lam50_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:38,871 - INFO -   eps=0.010, rho=0.15, lambda=50.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:38,874 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,874 - INFO - 
[234/2560] exp_0234_eps0.010_rho0.15_lam50_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:38,874 - INFO -   eps=0.010, rho=0.15, lambda=50.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:38,890 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,891 - INFO - 
[235/2560] exp_0235_eps0.010_rho0.15_lam50_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:38,891 - INFO -   eps=0.010, rho=0.15, lambda=50.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:38,894 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,895 - INFO - 
[236/2560] exp_0236_eps0.010_rho0.15_lam50_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:38,895 - INFO -   eps=0.010, rho=0.15, lambda=50.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:38,898 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,898 - INFO - 
[237/2560] exp_0237_eps0.010_rho0.15_lam100_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:38,898 - INFO -   eps=0.010, rho=0.15, lambda=100.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:38,901 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,901 - INFO - 
[238/2560] exp_0238_eps0.010_rho0.15_lam100_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:38,901 - INFO -   eps=0.010, rho=0.15, lambda=100.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:38,917 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,918 - INFO - 
[239/2560] exp_0239_eps0.010_rho0.15_lam100_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:38,918 - INFO -   eps=0.010, rho=0.15, lambda=100.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:38,921 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,926 - INFO - 
[240/2560] exp_0240_eps0.010_rho0.15_lam100_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:38,926 - INFO -   eps=0.010, rho=0.15, lambda=100.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:38,929 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,930 - INFO - 
[241/2560] exp_0241_eps0.010_rho0.30_lam0.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:38,930 - INFO -   eps=0.010, rho=0.3, lambda=0.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:38,933 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,946 - INFO - 
[242/2560] exp_0242_eps0.010_rho0.30_lam0.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:38,946 - INFO -   eps=0.010, rho=0.3, lambda=0.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:38,950 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,950 - INFO - 
[243/2560] exp_0243_eps0.010_rho0.30_lam0.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:38,950 - INFO -   eps=0.010, rho=0.3, lambda=0.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:38,953 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,954 - INFO - 
[244/2560] exp_0244_eps0.010_rho0.30_lam0.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:38,954 - INFO -   eps=0.010, rho=0.3, lambda=0.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:38,957 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,970 - INFO - 
[245/2560] exp_0245_eps0.010_rho0.30_lam0.5_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:38,970 - INFO -   eps=0.010, rho=0.3, lambda=0.5, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:38,974 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,974 - INFO - 
[246/2560] exp_0246_eps0.010_rho0.30_lam0.5_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:38,974 - INFO -   eps=0.010, rho=0.3, lambda=0.5, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:38,977 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,978 - INFO - 
[247/2560] exp_0247_eps0.010_rho0.30_lam0.5_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:38,978 - INFO -   eps=0.010, rho=0.3, lambda=0.5, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:38,981 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,981 - INFO - 
[248/2560] exp_0248_eps0.010_rho0.30_lam0.5_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:38,981 - INFO -   eps=0.010, rho=0.3, lambda=0.5, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:38,984 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:38,997 - INFO - 
[249/2560] exp_0249_eps0.010_rho0.30_lam1.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:38,997 - INFO -   eps=0.010, rho=0.3, lambda=1.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:39,000 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,001 - INFO - 
[250/2560] exp_0250_eps0.010_rho0.30_lam1.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:39,001 - INFO -   eps=0.010, rho=0.3, lambda=1.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:39,004 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,005 - INFO - 
[251/2560] exp_0251_eps0.010_rho0.30_lam1.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:39,005 - INFO -   eps=0.010, rho=0.3, lambda=1.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:39,008 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,021 - INFO - 
[252/2560] exp_0252_eps0.010_rho0.30_lam1.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:39,021 - INFO -   eps=0.010, rho=0.3, lambda=1.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:39,025 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,025 - INFO - 
[253/2560] exp_0253_eps0.010_rho0.30_lam1.5_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:39,026 - INFO -   eps=0.010, rho=0.3, lambda=1.5, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:39,029 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,029 - INFO - 
[254/2560] exp_0254_eps0.010_rho0.30_lam1.5_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:39,029 - INFO -   eps=0.010, rho=0.3, lambda=1.5, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:39,032 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,033 - INFO - 
[255/2560] exp_0255_eps0.010_rho0.30_lam1.5_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:39,033 - INFO -   eps=0.010, rho=0.3, lambda=1.5, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:39,036 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,049 - INFO - 
[256/2560] exp_0256_eps0.010_rho0.30_lam1.5_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:39,049 - INFO -   eps=0.010, rho=0.3, lambda=1.5, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:39,053 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,053 - INFO - 
[257/2560] exp_0257_eps0.010_rho0.30_lam2.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:39,053 - INFO -   eps=0.010, rho=0.3, lambda=2.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:39,056 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,057 - INFO - 
[258/2560] exp_0258_eps0.010_rho0.30_lam2.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:39,057 - INFO -   eps=0.010, rho=0.3, lambda=2.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:39,060 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,061 - INFO - 
[259/2560] exp_0259_eps0.010_rho0.30_lam2.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:39,061 - INFO -   eps=0.010, rho=0.3, lambda=2.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:39,064 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,064 - INFO - 
[260/2560] exp_0260_eps0.010_rho0.30_lam2.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:39,064 - INFO -   eps=0.010, rho=0.3, lambda=2.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:39,067 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,068 - INFO - 
[261/2560] exp_0261_eps0.010_rho0.30_lam2.5_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:39,068 - INFO -   eps=0.010, rho=0.3, lambda=2.5, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:39,071 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,071 - INFO - 
[262/2560] exp_0262_eps0.010_rho0.30_lam2.5_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:39,071 - INFO -   eps=0.010, rho=0.3, lambda=2.5, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:39,074 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,075 - INFO - 
[263/2560] exp_0263_eps0.010_rho0.30_lam2.5_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:39,075 - INFO -   eps=0.010, rho=0.3, lambda=2.5, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:39,078 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,078 - INFO - 
[264/2560] exp_0264_eps0.010_rho0.30_lam2.5_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:39,078 - INFO -   eps=0.010, rho=0.3, lambda=2.5, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:39,081 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,082 - INFO - 
[265/2560] exp_0265_eps0.010_rho0.30_lam3.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:39,082 - INFO -   eps=0.010, rho=0.3, lambda=3.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:39,085 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,085 - INFO - 
[266/2560] exp_0266_eps0.010_rho0.30_lam3.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:39,085 - INFO -   eps=0.010, rho=0.3, lambda=3.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:39,088 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,089 - INFO - 
[267/2560] exp_0267_eps0.010_rho0.30_lam3.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:39,089 - INFO -   eps=0.010, rho=0.3, lambda=3.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:39,092 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,092 - INFO - 
[268/2560] exp_0268_eps0.010_rho0.30_lam3.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:39,092 - INFO -   eps=0.010, rho=0.3, lambda=3.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:39,095 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,096 - INFO - 
[269/2560] exp_0269_eps0.010_rho0.30_lam10_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:39,096 - INFO -   eps=0.010, rho=0.3, lambda=10.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:39,099 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,100 - INFO - 
[270/2560] exp_0270_eps0.010_rho0.30_lam10_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:39,100 - INFO -   eps=0.010, rho=0.3, lambda=10.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:39,102 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,103 - INFO - 
[271/2560] exp_0271_eps0.010_rho0.30_lam10_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:39,103 - INFO -   eps=0.010, rho=0.3, lambda=10.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:39,106 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,107 - INFO - 
[272/2560] exp_0272_eps0.010_rho0.30_lam10_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:39,107 - INFO -   eps=0.010, rho=0.3, lambda=10.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:39,109 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,110 - INFO - 
[273/2560] exp_0273_eps0.010_rho0.30_lam50_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:39,110 - INFO -   eps=0.010, rho=0.3, lambda=50.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:39,113 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,114 - INFO - 
[274/2560] exp_0274_eps0.010_rho0.30_lam50_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:39,114 - INFO -   eps=0.010, rho=0.3, lambda=50.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:39,117 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,117 - INFO - 
[275/2560] exp_0275_eps0.010_rho0.30_lam50_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:39,117 - INFO -   eps=0.010, rho=0.3, lambda=50.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:39,120 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,121 - INFO - 
[276/2560] exp_0276_eps0.010_rho0.30_lam50_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:39,121 - INFO -   eps=0.010, rho=0.3, lambda=50.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:39,124 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,124 - INFO - 
[277/2560] exp_0277_eps0.010_rho0.30_lam100_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:39,124 - INFO -   eps=0.010, rho=0.3, lambda=100.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:39,127 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,128 - INFO - 
[278/2560] exp_0278_eps0.010_rho0.30_lam100_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:39,128 - INFO -   eps=0.010, rho=0.3, lambda=100.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:39,131 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,131 - INFO - 
[279/2560] exp_0279_eps0.010_rho0.30_lam100_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:39,131 - INFO -   eps=0.010, rho=0.3, lambda=100.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:39,135 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,135 - INFO - 
[280/2560] exp_0280_eps0.010_rho0.30_lam100_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:39,136 - INFO -   eps=0.010, rho=0.3, lambda=100.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:39,139 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,140 - INFO - 
[281/2560] exp_0281_eps0.010_rho0.50_lam0.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:39,140 - INFO -   eps=0.010, rho=0.5, lambda=0.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:39,143 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,144 - INFO - 
[282/2560] exp_0282_eps0.010_rho0.50_lam0.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:39,144 - INFO -   eps=0.010, rho=0.5, lambda=0.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:39,147 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,148 - INFO - 
[283/2560] exp_0283_eps0.010_rho0.50_lam0.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:39,148 - INFO -   eps=0.010, rho=0.5, lambda=0.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:39,151 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,152 - INFO - 
[284/2560] exp_0284_eps0.010_rho0.50_lam0.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:39,152 - INFO -   eps=0.010, rho=0.5, lambda=0.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:39,155 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,156 - INFO - 
[285/2560] exp_0285_eps0.010_rho0.50_lam0.5_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:39,156 - INFO -   eps=0.010, rho=0.5, lambda=0.5, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:39,160 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,160 - INFO - 
[286/2560] exp_0286_eps0.010_rho0.50_lam0.5_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:39,160 - INFO -   eps=0.010, rho=0.5, lambda=0.5, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:39,163 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,164 - INFO - 
[287/2560] exp_0287_eps0.010_rho0.50_lam0.5_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:39,164 - INFO -   eps=0.010, rho=0.5, lambda=0.5, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:39,168 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,169 - INFO - 
[288/2560] exp_0288_eps0.010_rho0.50_lam0.5_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:39,169 - INFO -   eps=0.010, rho=0.5, lambda=0.5, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:39,172 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,173 - INFO - 
[289/2560] exp_0289_eps0.010_rho0.50_lam1.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:39,173 - INFO -   eps=0.010, rho=0.5, lambda=1.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:39,176 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,177 - INFO - 
[290/2560] exp_0290_eps0.010_rho0.50_lam1.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:39,177 - INFO -   eps=0.010, rho=0.5, lambda=1.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:39,180 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,181 - INFO - 
[291/2560] exp_0291_eps0.010_rho0.50_lam1.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:39,181 - INFO -   eps=0.010, rho=0.5, lambda=1.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:39,184 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,185 - INFO - 
[292/2560] exp_0292_eps0.010_rho0.50_lam1.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:39,185 - INFO -   eps=0.010, rho=0.5, lambda=1.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:39,188 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,189 - INFO - 
[293/2560] exp_0293_eps0.010_rho0.50_lam1.5_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:39,189 - INFO -   eps=0.010, rho=0.5, lambda=1.5, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:39,192 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,193 - INFO - 
[294/2560] exp_0294_eps0.010_rho0.50_lam1.5_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:39,193 - INFO -   eps=0.010, rho=0.5, lambda=1.5, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:39,196 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,197 - INFO - 
[295/2560] exp_0295_eps0.010_rho0.50_lam1.5_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:39,197 - INFO -   eps=0.010, rho=0.5, lambda=1.5, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:39,200 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,202 - INFO - 
[296/2560] exp_0296_eps0.010_rho0.50_lam1.5_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:39,202 - INFO -   eps=0.010, rho=0.5, lambda=1.5, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:39,205 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,206 - INFO - 
[297/2560] exp_0297_eps0.010_rho0.50_lam2.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:39,206 - INFO -   eps=0.010, rho=0.5, lambda=2.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:39,209 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,210 - INFO - 
[298/2560] exp_0298_eps0.010_rho0.50_lam2.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:39,210 - INFO -   eps=0.010, rho=0.5, lambda=2.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:39,213 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,214 - INFO - 
[299/2560] exp_0299_eps0.010_rho0.50_lam2.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:39,214 - INFO -   eps=0.010, rho=0.5, lambda=2.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:39,217 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,218 - INFO - 
[300/2560] exp_0300_eps0.010_rho0.50_lam2.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:39,218 - INFO -   eps=0.010, rho=0.5, lambda=2.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:39,221 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,222 - INFO - 
[301/2560] exp_0301_eps0.010_rho0.50_lam2.5_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:39,222 - INFO -   eps=0.010, rho=0.5, lambda=2.5, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:39,225 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,226 - INFO - 
[302/2560] exp_0302_eps0.010_rho0.50_lam2.5_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:39,226 - INFO -   eps=0.010, rho=0.5, lambda=2.5, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:39,229 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,230 - INFO - 
[303/2560] exp_0303_eps0.010_rho0.50_lam2.5_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:39,230 - INFO -   eps=0.010, rho=0.5, lambda=2.5, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:39,234 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,234 - INFO - 
[304/2560] exp_0304_eps0.010_rho0.50_lam2.5_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:39,234 - INFO -   eps=0.010, rho=0.5, lambda=2.5, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:39,237 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,238 - INFO - 
[305/2560] exp_0305_eps0.010_rho0.50_lam3.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:39,238 - INFO -   eps=0.010, rho=0.5, lambda=3.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:39,242 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,242 - INFO - 
[306/2560] exp_0306_eps0.010_rho0.50_lam3.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:39,243 - INFO -   eps=0.010, rho=0.5, lambda=3.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:39,245 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,246 - INFO - 
[307/2560] exp_0307_eps0.010_rho0.50_lam3.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:39,246 - INFO -   eps=0.010, rho=0.5, lambda=3.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:39,250 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,251 - INFO - 
[308/2560] exp_0308_eps0.010_rho0.50_lam3.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:39,251 - INFO -   eps=0.010, rho=0.5, lambda=3.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:39,254 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,254 - INFO - 
[309/2560] exp_0309_eps0.010_rho0.50_lam10_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:39,255 - INFO -   eps=0.010, rho=0.5, lambda=10.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:39,258 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,259 - INFO - 
[310/2560] exp_0310_eps0.010_rho0.50_lam10_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:39,259 - INFO -   eps=0.010, rho=0.5, lambda=10.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:39,262 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,264 - INFO - 
[311/2560] exp_0311_eps0.010_rho0.50_lam10_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:39,264 - INFO -   eps=0.010, rho=0.5, lambda=10.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:39,267 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,268 - INFO - 
[312/2560] exp_0312_eps0.010_rho0.50_lam10_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:39,268 - INFO -   eps=0.010, rho=0.5, lambda=10.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:39,271 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,272 - INFO - 
[313/2560] exp_0313_eps0.010_rho0.50_lam50_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:39,273 - INFO -   eps=0.010, rho=0.5, lambda=50.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:39,275 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,277 - INFO - 
[314/2560] exp_0314_eps0.010_rho0.50_lam50_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:39,277 - INFO -   eps=0.010, rho=0.5, lambda=50.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:39,280 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,281 - INFO - 
[315/2560] exp_0315_eps0.010_rho0.50_lam50_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:39,282 - INFO -   eps=0.010, rho=0.5, lambda=50.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:39,285 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,286 - INFO - 
[316/2560] exp_0316_eps0.010_rho0.50_lam50_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:39,286 - INFO -   eps=0.010, rho=0.5, lambda=50.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:39,289 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,290 - INFO - 
[317/2560] exp_0317_eps0.010_rho0.50_lam100_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:39,290 - INFO -   eps=0.010, rho=0.5, lambda=100.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:39,293 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,294 - INFO - 
[318/2560] exp_0318_eps0.010_rho0.50_lam100_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:39,294 - INFO -   eps=0.010, rho=0.5, lambda=100.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:39,297 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,298 - INFO - 
[319/2560] exp_0319_eps0.010_rho0.50_lam100_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:39,298 - INFO -   eps=0.010, rho=0.5, lambda=100.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:39,301 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,302 - INFO - 
[320/2560] exp_0320_eps0.010_rho0.50_lam100_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:39,303 - INFO -   eps=0.010, rho=0.5, lambda=100.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:39,306 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,307 - INFO - 
[321/2560] exp_0321_eps0.020_rhobalanced_lam0.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:39,307 - INFO -   eps=0.020, rho=None, lambda=0.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:39,310 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,311 - INFO - 
[322/2560] exp_0322_eps0.020_rhobalanced_lam0.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:39,311 - INFO -   eps=0.020, rho=None, lambda=0.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:39,314 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,315 - INFO - 
[323/2560] exp_0323_eps0.020_rhobalanced_lam0.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:39,315 - INFO -   eps=0.020, rho=None, lambda=0.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:39,319 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,320 - INFO - 
[324/2560] exp_0324_eps0.020_rhobalanced_lam0.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:39,320 - INFO -   eps=0.020, rho=None, lambda=0.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:39,323 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,323 - INFO - 
[325/2560] exp_0325_eps0.020_rhobalanced_lam0.5_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:39,323 - INFO -   eps=0.020, rho=None, lambda=0.5, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:39,326 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,327 - INFO - 
[326/2560] exp_0326_eps0.020_rhobalanced_lam0.5_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:39,327 - INFO -   eps=0.020, rho=None, lambda=0.5, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:39,330 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,331 - INFO - 
[327/2560] exp_0327_eps0.020_rhobalanced_lam0.5_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:39,331 - INFO -   eps=0.020, rho=None, lambda=0.5, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:39,334 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,334 - INFO - 
[328/2560] exp_0328_eps0.020_rhobalanced_lam0.5_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:39,334 - INFO -   eps=0.020, rho=None, lambda=0.5, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:39,338 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,338 - INFO - 
[329/2560] exp_0329_eps0.020_rhobalanced_lam1.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:39,338 - INFO -   eps=0.020, rho=None, lambda=1.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:39,341 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,342 - INFO - 
[330/2560] exp_0330_eps0.020_rhobalanced_lam1.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:39,342 - INFO -   eps=0.020, rho=None, lambda=1.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:39,345 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,346 - INFO - 
[331/2560] exp_0331_eps0.020_rhobalanced_lam1.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:39,346 - INFO -   eps=0.020, rho=None, lambda=1.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:39,349 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,349 - INFO - 
[332/2560] exp_0332_eps0.020_rhobalanced_lam1.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:39,349 - INFO -   eps=0.020, rho=None, lambda=1.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:39,352 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,353 - INFO - 
[333/2560] exp_0333_eps0.020_rhobalanced_lam1.5_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:39,353 - INFO -   eps=0.020, rho=None, lambda=1.5, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:39,355 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,356 - INFO - 
[334/2560] exp_0334_eps0.020_rhobalanced_lam1.5_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:39,356 - INFO -   eps=0.020, rho=None, lambda=1.5, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:39,359 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,360 - INFO - 
[335/2560] exp_0335_eps0.020_rhobalanced_lam1.5_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:39,360 - INFO -   eps=0.020, rho=None, lambda=1.5, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:39,362 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,363 - INFO - 
[336/2560] exp_0336_eps0.020_rhobalanced_lam1.5_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:39,363 - INFO -   eps=0.020, rho=None, lambda=1.5, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:39,366 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,366 - INFO - 
[337/2560] exp_0337_eps0.020_rhobalanced_lam2.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:39,366 - INFO -   eps=0.020, rho=None, lambda=2.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:39,369 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,370 - INFO - 
[338/2560] exp_0338_eps0.020_rhobalanced_lam2.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:39,370 - INFO -   eps=0.020, rho=None, lambda=2.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:39,374 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,374 - INFO - 
[339/2560] exp_0339_eps0.020_rhobalanced_lam2.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:39,374 - INFO -   eps=0.020, rho=None, lambda=2.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:39,377 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,378 - INFO - 
[340/2560] exp_0340_eps0.020_rhobalanced_lam2.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:39,378 - INFO -   eps=0.020, rho=None, lambda=2.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:39,382 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,383 - INFO - 
[341/2560] exp_0341_eps0.020_rhobalanced_lam2.5_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:39,383 - INFO -   eps=0.020, rho=None, lambda=2.5, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:39,386 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,387 - INFO - 
[342/2560] exp_0342_eps0.020_rhobalanced_lam2.5_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:39,387 - INFO -   eps=0.020, rho=None, lambda=2.5, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:39,390 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,391 - INFO - 
[343/2560] exp_0343_eps0.020_rhobalanced_lam2.5_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:39,391 - INFO -   eps=0.020, rho=None, lambda=2.5, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:39,394 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,395 - INFO - 
[344/2560] exp_0344_eps0.020_rhobalanced_lam2.5_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:39,395 - INFO -   eps=0.020, rho=None, lambda=2.5, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:39,398 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,398 - INFO - 
[345/2560] exp_0345_eps0.020_rhobalanced_lam3.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:39,398 - INFO -   eps=0.020, rho=None, lambda=3.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:39,401 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,402 - INFO - 
[346/2560] exp_0346_eps0.020_rhobalanced_lam3.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:39,402 - INFO -   eps=0.020, rho=None, lambda=3.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:39,405 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,405 - INFO - 
[347/2560] exp_0347_eps0.020_rhobalanced_lam3.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:39,405 - INFO -   eps=0.020, rho=None, lambda=3.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:39,408 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,409 - INFO - 
[348/2560] exp_0348_eps0.020_rhobalanced_lam3.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:39,409 - INFO -   eps=0.020, rho=None, lambda=3.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:39,412 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,412 - INFO - 
[349/2560] exp_0349_eps0.020_rhobalanced_lam10_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:39,412 - INFO -   eps=0.020, rho=None, lambda=10.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:39,426 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,427 - INFO - 
[350/2560] exp_0350_eps0.020_rhobalanced_lam10_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:39,427 - INFO -   eps=0.020, rho=None, lambda=10.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:39,430 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,431 - INFO - 
[351/2560] exp_0351_eps0.020_rhobalanced_lam10_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:39,431 - INFO -   eps=0.020, rho=None, lambda=10.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:39,433 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,434 - INFO - 
[352/2560] exp_0352_eps0.020_rhobalanced_lam10_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:39,434 - INFO -   eps=0.020, rho=None, lambda=10.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:39,437 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,437 - INFO - 
[353/2560] exp_0353_eps0.020_rhobalanced_lam50_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:39,437 - INFO -   eps=0.020, rho=None, lambda=50.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:39,440 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,452 - INFO - 
[354/2560] exp_0354_eps0.020_rhobalanced_lam50_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:39,452 - INFO -   eps=0.020, rho=None, lambda=50.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:39,456 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,457 - INFO - 
[355/2560] exp_0355_eps0.020_rhobalanced_lam50_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:39,457 - INFO -   eps=0.020, rho=None, lambda=50.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:39,461 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,461 - INFO - 
[356/2560] exp_0356_eps0.020_rhobalanced_lam50_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:39,461 - INFO -   eps=0.020, rho=None, lambda=50.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:39,466 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,467 - INFO - 
[357/2560] exp_0357_eps0.020_rhobalanced_lam100_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:39,467 - INFO -   eps=0.020, rho=None, lambda=100.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:39,470 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,471 - INFO - 
[358/2560] exp_0358_eps0.020_rhobalanced_lam100_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:39,471 - INFO -   eps=0.020, rho=None, lambda=100.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:39,475 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,476 - INFO - 
[359/2560] exp_0359_eps0.020_rhobalanced_lam100_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:39,476 - INFO -   eps=0.020, rho=None, lambda=100.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:39,479 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,480 - INFO - 
[360/2560] exp_0360_eps0.020_rhobalanced_lam100_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:39,480 - INFO -   eps=0.020, rho=None, lambda=100.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:39,484 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,485 - INFO - 
[361/2560] exp_0361_eps0.020_rho0.01_lam0.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:39,485 - INFO -   eps=0.020, rho=0.01, lambda=0.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:39,488 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,489 - INFO - 
[362/2560] exp_0362_eps0.020_rho0.01_lam0.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:39,489 - INFO -   eps=0.020, rho=0.01, lambda=0.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:39,493 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,493 - INFO - 
[363/2560] exp_0363_eps0.020_rho0.01_lam0.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:39,493 - INFO -   eps=0.020, rho=0.01, lambda=0.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:39,497 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,498 - INFO - 
[364/2560] exp_0364_eps0.020_rho0.01_lam0.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:39,498 - INFO -   eps=0.020, rho=0.01, lambda=0.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:39,501 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,502 - INFO - 
[365/2560] exp_0365_eps0.020_rho0.01_lam0.5_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:39,502 - INFO -   eps=0.020, rho=0.01, lambda=0.5, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:39,506 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,506 - INFO - 
[366/2560] exp_0366_eps0.020_rho0.01_lam0.5_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:39,506 - INFO -   eps=0.020, rho=0.01, lambda=0.5, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:39,510 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,510 - INFO - 
[367/2560] exp_0367_eps0.020_rho0.01_lam0.5_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:39,511 - INFO -   eps=0.020, rho=0.01, lambda=0.5, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:39,514 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,515 - INFO - 
[368/2560] exp_0368_eps0.020_rho0.01_lam0.5_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:39,515 - INFO -   eps=0.020, rho=0.01, lambda=0.5, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:39,518 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,519 - INFO - 
[369/2560] exp_0369_eps0.020_rho0.01_lam1.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:39,519 - INFO -   eps=0.020, rho=0.01, lambda=1.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:39,522 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,523 - INFO - 
[370/2560] exp_0370_eps0.020_rho0.01_lam1.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:39,523 - INFO -   eps=0.020, rho=0.01, lambda=1.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:39,527 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,527 - INFO - 
[371/2560] exp_0371_eps0.020_rho0.01_lam1.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:39,528 - INFO -   eps=0.020, rho=0.01, lambda=1.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:39,531 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,532 - INFO - 
[372/2560] exp_0372_eps0.020_rho0.01_lam1.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:39,532 - INFO -   eps=0.020, rho=0.01, lambda=1.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:39,535 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,536 - INFO - 
[373/2560] exp_0373_eps0.020_rho0.01_lam1.5_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:39,536 - INFO -   eps=0.020, rho=0.01, lambda=1.5, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:39,539 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,540 - INFO - 
[374/2560] exp_0374_eps0.020_rho0.01_lam1.5_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:39,540 - INFO -   eps=0.020, rho=0.01, lambda=1.5, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:39,543 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,544 - INFO - 
[375/2560] exp_0375_eps0.020_rho0.01_lam1.5_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:39,544 - INFO -   eps=0.020, rho=0.01, lambda=1.5, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:39,547 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,548 - INFO - 
[376/2560] exp_0376_eps0.020_rho0.01_lam1.5_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:39,548 - INFO -   eps=0.020, rho=0.01, lambda=1.5, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:39,552 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,552 - INFO - 
[377/2560] exp_0377_eps0.020_rho0.01_lam2.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:39,552 - INFO -   eps=0.020, rho=0.01, lambda=2.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:39,556 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,556 - INFO - 
[378/2560] exp_0378_eps0.020_rho0.01_lam2.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:39,557 - INFO -   eps=0.020, rho=0.01, lambda=2.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:39,560 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,573 - INFO - 
[379/2560] exp_0379_eps0.020_rho0.01_lam2.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:39,573 - INFO -   eps=0.020, rho=0.01, lambda=2.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:39,578 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,578 - INFO - 
[380/2560] exp_0380_eps0.020_rho0.01_lam2.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:39,578 - INFO -   eps=0.020, rho=0.01, lambda=2.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:39,582 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,583 - INFO - 
[381/2560] exp_0381_eps0.020_rho0.01_lam2.5_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:39,583 - INFO -   eps=0.020, rho=0.01, lambda=2.5, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:39,586 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,595 - INFO - 
[382/2560] exp_0382_eps0.020_rho0.01_lam2.5_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:39,595 - INFO -   eps=0.020, rho=0.01, lambda=2.5, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:39,600 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,601 - INFO - 
[383/2560] exp_0383_eps0.020_rho0.01_lam2.5_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:39,601 - INFO -   eps=0.020, rho=0.01, lambda=2.5, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:39,605 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,606 - INFO - 
[384/2560] exp_0384_eps0.020_rho0.01_lam2.5_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:39,607 - INFO -   eps=0.020, rho=0.01, lambda=2.5, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:39,610 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,612 - INFO - 
[385/2560] exp_0385_eps0.020_rho0.01_lam3.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:39,612 - INFO -   eps=0.020, rho=0.01, lambda=3.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:39,616 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,617 - INFO - 
[386/2560] exp_0386_eps0.020_rho0.01_lam3.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:39,617 - INFO -   eps=0.020, rho=0.01, lambda=3.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:39,621 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,622 - INFO - 
[387/2560] exp_0387_eps0.020_rho0.01_lam3.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:39,622 - INFO -   eps=0.020, rho=0.01, lambda=3.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:39,626 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,628 - INFO - 
[388/2560] exp_0388_eps0.020_rho0.01_lam3.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:39,628 - INFO -   eps=0.020, rho=0.01, lambda=3.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:39,632 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,633 - INFO - 
[389/2560] exp_0389_eps0.020_rho0.01_lam10_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:39,633 - INFO -   eps=0.020, rho=0.01, lambda=10.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:39,637 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,639 - INFO - 
[390/2560] exp_0390_eps0.020_rho0.01_lam10_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:39,639 - INFO -   eps=0.020, rho=0.01, lambda=10.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:39,643 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,644 - INFO - 
[391/2560] exp_0391_eps0.020_rho0.01_lam10_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:39,644 - INFO -   eps=0.020, rho=0.01, lambda=10.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:39,648 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,649 - INFO - 
[392/2560] exp_0392_eps0.020_rho0.01_lam10_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:39,650 - INFO -   eps=0.020, rho=0.01, lambda=10.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:39,654 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,655 - INFO - 
[393/2560] exp_0393_eps0.020_rho0.01_lam50_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:39,655 - INFO -   eps=0.020, rho=0.01, lambda=50.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:39,658 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,659 - INFO - 
[394/2560] exp_0394_eps0.020_rho0.01_lam50_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:39,659 - INFO -   eps=0.020, rho=0.01, lambda=50.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:39,663 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,663 - INFO - 
[395/2560] exp_0395_eps0.020_rho0.01_lam50_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:39,663 - INFO -   eps=0.020, rho=0.01, lambda=50.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:39,667 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,668 - INFO - 
[396/2560] exp_0396_eps0.020_rho0.01_lam50_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:39,668 - INFO -   eps=0.020, rho=0.01, lambda=50.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:39,671 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,673 - INFO - 
[397/2560] exp_0397_eps0.020_rho0.01_lam100_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:39,674 - INFO -   eps=0.020, rho=0.01, lambda=100.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:39,677 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,679 - INFO - 
[398/2560] exp_0398_eps0.020_rho0.01_lam100_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:39,679 - INFO -   eps=0.020, rho=0.01, lambda=100.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:39,683 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,685 - INFO - 
[399/2560] exp_0399_eps0.020_rho0.01_lam100_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:39,685 - INFO -   eps=0.020, rho=0.01, lambda=100.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:39,688 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,689 - INFO - 
[400/2560] exp_0400_eps0.020_rho0.01_lam100_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:39,689 - INFO -   eps=0.020, rho=0.01, lambda=100.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:39,693 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,693 - INFO - 
[401/2560] exp_0401_eps0.020_rho0.02_lam0.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:39,693 - INFO -   eps=0.020, rho=0.02, lambda=0.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:39,698 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,699 - INFO - 
[402/2560] exp_0402_eps0.020_rho0.02_lam0.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:39,699 - INFO -   eps=0.020, rho=0.02, lambda=0.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:39,703 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,705 - INFO - 
[403/2560] exp_0403_eps0.020_rho0.02_lam0.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:39,705 - INFO -   eps=0.020, rho=0.02, lambda=0.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:39,709 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,711 - INFO - 
[404/2560] exp_0404_eps0.020_rho0.02_lam0.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:39,711 - INFO -   eps=0.020, rho=0.02, lambda=0.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:39,717 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,718 - INFO - 
[405/2560] exp_0405_eps0.020_rho0.02_lam0.5_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:39,718 - INFO -   eps=0.020, rho=0.02, lambda=0.5, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:39,722 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,723 - INFO - 
[406/2560] exp_0406_eps0.020_rho0.02_lam0.5_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:39,723 - INFO -   eps=0.020, rho=0.02, lambda=0.5, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:39,726 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,727 - INFO - 
[407/2560] exp_0407_eps0.020_rho0.02_lam0.5_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:39,727 - INFO -   eps=0.020, rho=0.02, lambda=0.5, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:39,732 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,733 - INFO - 
[408/2560] exp_0408_eps0.020_rho0.02_lam0.5_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:39,733 - INFO -   eps=0.020, rho=0.02, lambda=0.5, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:39,737 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,738 - INFO - 
[409/2560] exp_0409_eps0.020_rho0.02_lam1.0_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:39,738 - INFO -   eps=0.020, rho=0.02, lambda=1.0, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:39,742 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,743 - INFO - 
[410/2560] exp_0410_eps0.020_rho0.02_lam1.0_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:39,743 - INFO -   eps=0.020, rho=0.02, lambda=1.0, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:39,747 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,747 - INFO - 
[411/2560] exp_0411_eps0.020_rho0.02_lam1.0_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:39,748 - INFO -   eps=0.020, rho=0.02, lambda=1.0, debias=False, dyn_rast=True, adapt_sigma=False
2025-12-05 23:32:39,751 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,752 - INFO - 
[412/2560] exp_0412_eps0.020_rho0.02_lam1.0_debiasFalse_dynrastTrue_adapsigmaTrue
2025-12-05 23:32:39,752 - INFO -   eps=0.020, rho=0.02, lambda=1.0, debias=False, dyn_rast=True, adapt_sigma=True
2025-12-05 23:32:39,756 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,757 - INFO - 
[413/2560] exp_0413_eps0.020_rho0.02_lam1.5_debiasFalse_dynrastFalse_adapsigmaFalse
2025-12-05 23:32:39,757 - INFO -   eps=0.020, rho=0.02, lambda=1.5, debias=False, dyn_rast=False, adapt_sigma=False
2025-12-05 23:32:39,761 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,761 - INFO - 
[414/2560] exp_0414_eps0.020_rho0.02_lam1.5_debiasFalse_dynrastFalse_adapsigmaTrue
2025-12-05 23:32:39,762 - INFO -   eps=0.020, rho=0.02, lambda=1.5, debias=False, dyn_rast=False, adapt_sigma=True
2025-12-05 23:32:39,765 - ERROR -   ✗ Erreur: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 201, in run_ablation_studies
    torch.cuda.empty_cache()
                 ^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/notebooks/ablation_studies.py", line 99, in compute_transport_plan
    F_pot, G_pot = self.loss_layer(w_a, X_a, w_b, X_b)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/samples_loss.py", line 265, in forward
    values = routines[self.loss][backend](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 180, in sinkhorn_tensorized
    C_xy = cost(x, y.detach())  # (B,N,M) torch Tensor
           ^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/sinkhorn_samples.py", line 29, in <lambda>
    2: (lambda x, y: squared_distances(x, y) / 2),
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Data/janis.aiad/geodata/.venv/lib/python3.11/site-packages/geomloss/utils.py", line 49, in squared_distances
    D_xy = torch.matmul(x, y.permute(0, 2, 1))  # (B,N,D) @ (B,D,M) = (B,N,M)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 91.20 GiB. GPU 0 has a total capacity of 19.53 GiB of which 19.18 GiB is free. Including non-PyTorch memory, this process has 206.00 MiB memory in use. Of the allocated memory 11.34 MiB is allocated by PyTorch, and 10.66 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-05 23:32:39,766 - INFO - 
[415/2560] exp_0415_eps0.020_rho0.02_lam1.5_debiasFalse_dynrastTrue_adapsigmaFalse
2025-12-05 23:32:39,766 - INFO -   eps=0.020, rho=0.02, lambda=1.5, debias=False, dyn_rast=True, adapt_sigma=False
